{"ast":null,"code":"var _jsxFileName = \"/home/gauravpendherkar/DemoWriti/src/containers/UserAuth/Otp/index.js\";\nimport React, { useEffect, useState } from 'react';\nimport { createForm } from 'rc-form';\nimport { connect } from 'react-redux';\nimport OtpPageUI from './OtpPageUI';\nimport axios from '../../../services/api/config';\nimport { verifyOtp, resendOtpLink } from '../../../services/api/routes/auth';\nimport { userSignOut, setOtpVerified } from '../../../appRedux/actions/Auth';\nimport { addUserData } from '../../../util/DBService';\nimport UtilService, { isDrOrNp, getUserBaseRedirect } from '../../../util/common';\nimport { SET_OTP_VERIFIED, SIGNOUT_USER_SUCCESS } from '../../../appRedux/ActionTypes';\nimport { Toast } from '../../../components/common/Toast';\n\nfunction OTP(props) {\n  const [email, setEmail] = useState(undefined);\n  const [contactNo, setContactNo] = useState(undefined);\n  const [disbaleLink, setDisbaleLink] = useState(true);\n  const [disbaleBtn, setDisbaleBtn] = useState(false);\n  const [count, setCount] = useState(0);\n  const {\n    authUser\n  } = props;\n  useEffect(() => {\n    startTimer();\n    setUserEmail(authUser);\n    setUserConatctNo(authUser);\n  }, []);\n\n  function startTimer() {\n    var timeLeft = 60;\n    var timerid = setInterval(countdown, 1000);\n    console.log(\"ðŸš€ ~ file: index.js ~ line 33 ~ startTimer ~ timerid\", timerid);\n\n    function countdown() {\n      if (timeLeft == 0) {\n        clearTimeout(timerid);\n        setDisbaleLink(false);\n        setCount(0);\n      } else {\n        setCount(timeLeft);\n        timeLeft--;\n      }\n    }\n  }\n\n  ;\n\n  const setUserConatctNo = authUser => {\n    if (authUser && authUser.mobiles && authUser.mobiles.length > 0 && authUser.mobiles[0].mobile) {\n      let contactno = authUser.mobiles[0].mobile; //Hide email partially\n\n      let PartiallyHidedContactNo = \"*\".repeat(contactno.length - 4) + contactno.substr(contactno.length - 4);\n      setContactNo(PartiallyHidedContactNo);\n    }\n  };\n\n  const setUserEmail = authUser => {\n    if (authUser && authUser.emails && authUser.emails.length > 0 && authUser.emails[0].email) {\n      let email = authUser.emails[0].email; //Hide email partially\n\n      let len = Math.floor(email.substr(0, email.indexOf(\"@\")).length / 2);\n      let PartiallyHidedEmail = \"*\".repeat(len) + email.substr(len + 1);\n      setEmail(PartiallyHidedEmail);\n    }\n  };\n\n  const handleResendLink = () => {\n    setDisbaleLink(true);\n    let {\n      method,\n      url,\n      baseURL\n    } = resendOtpLink;\n    axios({\n      method,\n      url,\n      baseURL\n    }).then(({\n      data\n    }) => {\n      startTimer();\n    }).catch(err => startTimer());\n  };\n\n  const handleOtpSubmit = e => {\n    e.preventDefault();\n    props.form.validateFields((error, value) => {\n      console.log(error, value);\n\n      if (error) {\n        return;\n      }\n\n      setDisbaleBtn(true);\n      axios({ ...verifyOtp,\n        data: { ...value,\n          extendCheck: false\n        }\n      }).then(({\n        data\n      }) => {\n        setDisbaleBtn(false); // startTimer()\n\n        if (data.code === 'OK') {\n          props.setOtpVerified(SET_OTP_VERIFIED, true);\n          localStorage.setItem('otpVerified', JSON.stringify(true));\n          console.log(\"TCL: handleOtpSubmit -> value\", value);\n\n          if (value.extendCheck) {\n            addUserData({\n              email: UtilService.getPrimaryValue(authUser.emails, \"email\")\n            });\n          }\n\n          props.history.push({\n            pathname: getUserBaseRedirect(props.authUser)\n          });\n          props.form.resetFields();\n        } else {\n          // props.userSignOut(SIGNOUT_USER_SUCCESS, () => {\n          //     props.history.push({\n          //         pathname: routes.login.path\n          //     })\n          // })\n          Toast.error(data.message);\n        }\n      }).catch(err => {\n        // startTimer()\n        setDisbaleBtn(false);\n      });\n    });\n  };\n\n  const handleUserLogout = () => {\n    props.userSignOut(SIGNOUT_USER_SUCCESS);\n  };\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(OtpPageUI, {\n    form: props.form,\n    timer: count,\n    email: email,\n    contactNo: contactNo,\n    onOtpSubmit: handleOtpSubmit,\n    disbaleLink: disbaleLink,\n    onResentLink: handleResendLink,\n    disbaleBtn: disbaleBtn,\n    onUserLogout: handleUserLogout,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 13\n    }\n  }));\n}\n\nconst mapStateToProps = ({\n  auth\n}) => {\n  const {\n    authUser\n  } = auth;\n  return {\n    authUser\n  };\n};\n\nexport default connect(mapStateToProps, {\n  userSignOut,\n  setOtpVerified\n})(createForm()(OTP));","map":{"version":3,"sources":["/home/gauravpendherkar/DemoWriti/src/containers/UserAuth/Otp/index.js"],"names":["React","useEffect","useState","createForm","connect","OtpPageUI","axios","verifyOtp","resendOtpLink","userSignOut","setOtpVerified","addUserData","UtilService","isDrOrNp","getUserBaseRedirect","SET_OTP_VERIFIED","SIGNOUT_USER_SUCCESS","Toast","OTP","props","email","setEmail","undefined","contactNo","setContactNo","disbaleLink","setDisbaleLink","disbaleBtn","setDisbaleBtn","count","setCount","authUser","startTimer","setUserEmail","setUserConatctNo","timeLeft","timerid","setInterval","countdown","console","log","clearTimeout","mobiles","length","mobile","contactno","PartiallyHidedContactNo","repeat","substr","emails","len","Math","floor","indexOf","PartiallyHidedEmail","handleResendLink","method","url","baseURL","then","data","catch","err","handleOtpSubmit","e","preventDefault","form","validateFields","error","value","extendCheck","code","localStorage","setItem","JSON","stringify","getPrimaryValue","history","push","pathname","resetFields","message","handleUserLogout","mapStateToProps","auth"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,SAAhB,EAA2BC,QAA3B,QAA2C,OAA3C;AACA,SAASC,UAAT,QAA2B,SAA3B;AACA,SAASC,OAAT,QAAwB,aAAxB;AACA,OAAOC,SAAP,MAAsB,aAAtB;AACA,OAAOC,KAAP,MAAkB,8BAAlB;AACA,SAASC,SAAT,EAAoBC,aAApB,QAAyC,mCAAzC;AACA,SAASC,WAAT,EAAsBC,cAAtB,QAA4C,gCAA5C;AACA,SAASC,WAAT,QAA4B,yBAA5B;AACA,OAAOC,WAAP,IAAsBC,QAAtB,EAAgCC,mBAAhC,QAA2D,sBAA3D;AACA,SAASC,gBAAT,EAA2BC,oBAA3B,QAAuD,+BAAvD;AACA,SAASC,KAAT,QAAsB,kCAAtB;;AAEA,SAASC,GAAT,CAAaC,KAAb,EAAoB;AAChB,QAAM,CAACC,KAAD,EAAQC,QAAR,IAAoBnB,QAAQ,CAACoB,SAAD,CAAlC;AACA,QAAM,CAACC,SAAD,EAAYC,YAAZ,IAA4BtB,QAAQ,CAACoB,SAAD,CAA1C;AACA,QAAM,CAACG,WAAD,EAAcC,cAAd,IAAgCxB,QAAQ,CAAC,IAAD,CAA9C;AACA,QAAM,CAACyB,UAAD,EAAaC,aAAb,IAA8B1B,QAAQ,CAAC,KAAD,CAA5C;AACA,QAAM,CAAC2B,KAAD,EAAQC,QAAR,IAAoB5B,QAAQ,CAAC,CAAD,CAAlC;AAEA,QAAM;AAAE6B,IAAAA;AAAF,MAAeZ,KAArB;AAEAlB,EAAAA,SAAS,CAAC,MAAM;AAEZ+B,IAAAA,UAAU;AACVC,IAAAA,YAAY,CAACF,QAAD,CAAZ;AACAG,IAAAA,gBAAgB,CAACH,QAAD,CAAhB;AAEH,GANQ,EAMN,EANM,CAAT;;AAQA,WAASC,UAAT,GAAsB;AAClB,QAAIG,QAAQ,GAAG,EAAf;AACA,QAAIC,OAAO,GAAGC,WAAW,CAACC,SAAD,EAAY,IAAZ,CAAzB;AACAC,IAAAA,OAAO,CAACC,GAAR,CAAY,sDAAZ,EAAoEJ,OAApE;;AACA,aAASE,SAAT,GAAqB;AACjB,UAAIH,QAAQ,IAAI,CAAhB,EAAmB;AACfM,QAAAA,YAAY,CAACL,OAAD,CAAZ;AACAV,QAAAA,cAAc,CAAC,KAAD,CAAd;AACAI,QAAAA,QAAQ,CAAC,CAAD,CAAR;AACH,OAJD,MAIO;AACHA,QAAAA,QAAQ,CAACK,QAAD,CAAR;AACAA,QAAAA,QAAQ;AACX;AACJ;AACJ;;AAAA;;AAED,QAAMD,gBAAgB,GAAIH,QAAD,IAAc;AACnC,QAAIA,QAAQ,IAAIA,QAAQ,CAACW,OAArB,IAAgCX,QAAQ,CAACW,OAAT,CAAiBC,MAAjB,GAA0B,CAA1D,IAA+DZ,QAAQ,CAACW,OAAT,CAAiB,CAAjB,EAAoBE,MAAvF,EAA+F;AAC3F,UAAIC,SAAS,GAAGd,QAAQ,CAACW,OAAT,CAAiB,CAAjB,EAAoBE,MAApC,CAD2F,CAE3F;;AACA,UAAIE,uBAAuB,GACvB,IAAIC,MAAJ,CAAWF,SAAS,CAACF,MAAV,GAAmB,CAA9B,IACAE,SAAS,CAACG,MAAV,CAAiBH,SAAS,CAACF,MAAV,GAAmB,CAApC,CAFJ;AAGAnB,MAAAA,YAAY,CAACsB,uBAAD,CAAZ;AACH;AACJ,GATD;;AAWA,QAAMb,YAAY,GAAIF,QAAD,IAAc;AAC/B,QAAIA,QAAQ,IAAIA,QAAQ,CAACkB,MAArB,IAA+BlB,QAAQ,CAACkB,MAAT,CAAgBN,MAAhB,GAAyB,CAAxD,IAA6DZ,QAAQ,CAACkB,MAAT,CAAgB,CAAhB,EAAmB7B,KAApF,EAA2F;AACvF,UAAIA,KAAK,GAAGW,QAAQ,CAACkB,MAAT,CAAgB,CAAhB,EAAmB7B,KAA/B,CADuF,CAEvF;;AACA,UAAI8B,GAAG,GAAGC,IAAI,CAACC,KAAL,CAAWhC,KAAK,CAAC4B,MAAN,CAAa,CAAb,EAAgB5B,KAAK,CAACiC,OAAN,CAAc,GAAd,CAAhB,EAAoCV,MAApC,GAA6C,CAAxD,CAAV;AACA,UAAIW,mBAAmB,GAAG,IAAIP,MAAJ,CAAWG,GAAX,IAAkB9B,KAAK,CAAC4B,MAAN,CAAaE,GAAG,GAAG,CAAnB,CAA5C;AACA7B,MAAAA,QAAQ,CAACiC,mBAAD,CAAR;AACH;AACJ,GARD;;AASA,QAAMC,gBAAgB,GAAG,MAAM;AAC3B7B,IAAAA,cAAc,CAAC,IAAD,CAAd;AACA,QAAI;AAAE8B,MAAAA,MAAF;AAAUC,MAAAA,GAAV;AAAeC,MAAAA;AAAf,QAA2BlD,aAA/B;AACAF,IAAAA,KAAK,CAAC;AAAEkD,MAAAA,MAAF;AAAUC,MAAAA,GAAV;AAAeC,MAAAA;AAAf,KAAD,CAAL,CAAgCC,IAAhC,CAAqC,CAAC;AAAEC,MAAAA;AAAF,KAAD,KAAc;AAC/C5B,MAAAA,UAAU;AACb,KAFD,EAEG6B,KAFH,CAESC,GAAG,IAAI9B,UAAU,EAF1B;AAGH,GAND;;AAOA,QAAM+B,eAAe,GAAIC,CAAD,IAAO;AAC3BA,IAAAA,CAAC,CAACC,cAAF;AACA9C,IAAAA,KAAK,CAAC+C,IAAN,CAAWC,cAAX,CAA0B,CAACC,KAAD,EAAQC,KAAR,KAAkB;AACxC9B,MAAAA,OAAO,CAACC,GAAR,CAAY4B,KAAZ,EAAmBC,KAAnB;;AACA,UAAID,KAAJ,EAAW;AACP;AACH;;AACDxC,MAAAA,aAAa,CAAC,IAAD,CAAb;AAEAtB,MAAAA,KAAK,CAAC,EAAE,GAAGC,SAAL;AAAgBqD,QAAAA,IAAI,EAAE,EAAE,GAAGS,KAAL;AAAYC,UAAAA,WAAW,EAAE;AAAzB;AAAtB,OAAD,CAAL,CAAgEX,IAAhE,CAAqE,CAAC;AAAEC,QAAAA;AAAF,OAAD,KAAc;AAC/EhC,QAAAA,aAAa,CAAC,KAAD,CAAb,CAD+E,CAE/E;;AACA,YAAIgC,IAAI,CAACW,IAAL,KAAc,IAAlB,EAAwB;AACpBpD,UAAAA,KAAK,CAACT,cAAN,CAAqBK,gBAArB,EAAuC,IAAvC;AACAyD,UAAAA,YAAY,CAACC,OAAb,CAAqB,aAArB,EAAoCC,IAAI,CAACC,SAAL,CAAe,IAAf,CAApC;AACApC,UAAAA,OAAO,CAACC,GAAR,CAAY,+BAAZ,EAA6C6B,KAA7C;;AACA,cAAIA,KAAK,CAACC,WAAV,EAAuB;AACnB3D,YAAAA,WAAW,CAAC;AAAES,cAAAA,KAAK,EAAER,WAAW,CAACgE,eAAZ,CAA4B7C,QAAQ,CAACkB,MAArC,EAA6C,OAA7C;AAAT,aAAD,CAAX;AACH;;AACD9B,UAAAA,KAAK,CAAC0D,OAAN,CAAcC,IAAd,CAAmB;AACfC,YAAAA,QAAQ,EAAEjE,mBAAmB,CAACK,KAAK,CAACY,QAAP;AADd,WAAnB;AAGAZ,UAAAA,KAAK,CAAC+C,IAAN,CAAWc,WAAX;AACH,SAXD,MAYK;AACD;AACA;AACA;AACA;AACA;AACA/D,UAAAA,KAAK,CAACmD,KAAN,CAAYR,IAAI,CAACqB,OAAjB;AACH;AACJ,OAvBD,EAuBGpB,KAvBH,CAuBSC,GAAG,IAAI;AACZ;AACAlC,QAAAA,aAAa,CAAC,KAAD,CAAb;AACH,OA1BD;AA2BH,KAlCD;AAmCH,GArCD;;AAsCA,QAAMsD,gBAAgB,GAAG,MAAM;AAC3B/D,IAAAA,KAAK,CAACV,WAAN,CAAkBO,oBAAlB;AACH,GAFD;;AAGA,sBACI,uDACI,oBAAC,SAAD;AAAW,IAAA,IAAI,EAAEG,KAAK,CAAC+C,IAAvB;AAA6B,IAAA,KAAK,EAAErC,KAApC;AACI,IAAA,KAAK,EAAET,KADX;AAEI,IAAA,SAAS,EAAEG,SAFf;AAGI,IAAA,WAAW,EAAEwC,eAHjB;AAII,IAAA,WAAW,EAAEtC,WAJjB;AAKI,IAAA,YAAY,EAAE8B,gBALlB;AAMI,IAAA,UAAU,EAAE5B,UANhB;AAOI,IAAA,YAAY,EAAEuD,gBAPlB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADJ,CADJ;AAeH;;AACD,MAAMC,eAAe,GAAG,CAAC;AAAEC,EAAAA;AAAF,CAAD,KAAc;AAClC,QAAM;AAAErD,IAAAA;AAAF,MAAeqD,IAArB;AACA,SAAO;AACHrD,IAAAA;AADG,GAAP;AAGH,CALD;;AAMA,eAAe3B,OAAO,CAAC+E,eAAD,EAAkB;AAAE1E,EAAAA,WAAF;AAAeC,EAAAA;AAAf,CAAlB,CAAP,CAA0DP,UAAU,GAAGe,GAAH,CAApE,CAAf","sourcesContent":["import React, { useEffect, useState } from 'react'\nimport { createForm } from 'rc-form';\nimport { connect } from 'react-redux'\nimport OtpPageUI from './OtpPageUI'\nimport axios from '../../../services/api/config'\nimport { verifyOtp, resendOtpLink } from '../../../services/api/routes/auth'\nimport { userSignOut, setOtpVerified } from '../../../appRedux/actions/Auth'\nimport { addUserData } from '../../../util/DBService'\nimport UtilService, { isDrOrNp, getUserBaseRedirect } from '../../../util/common'\nimport { SET_OTP_VERIFIED, SIGNOUT_USER_SUCCESS } from '../../../appRedux/ActionTypes';\nimport { Toast } from '../../../components/common/Toast'\n\nfunction OTP(props) {\n    const [email, setEmail] = useState(undefined)\n    const [contactNo, setContactNo] = useState(undefined)\n    const [disbaleLink, setDisbaleLink] = useState(true)\n    const [disbaleBtn, setDisbaleBtn] = useState(false)\n    const [count, setCount] = useState(0)\n\n    const { authUser } = props\n\n    useEffect(() => {\n\n        startTimer()\n        setUserEmail(authUser)\n        setUserConatctNo(authUser)\n\n    }, [])\n\n    function startTimer() {\n        var timeLeft = 60;\n        var timerid = setInterval(countdown, 1000);\n        console.log(\"ðŸš€ ~ file: index.js ~ line 33 ~ startTimer ~ timerid\", timerid)\n        function countdown() {\n            if (timeLeft == 0) {\n                clearTimeout(timerid);\n                setDisbaleLink(false)\n                setCount(0)\n            } else {\n                setCount(timeLeft)\n                timeLeft--;\n            }\n        }\n    };\n\n    const setUserConatctNo = (authUser) => {\n        if (authUser && authUser.mobiles && authUser.mobiles.length > 0 && authUser.mobiles[0].mobile) {\n            let contactno = authUser.mobiles[0].mobile;\n            //Hide email partially\n            let PartiallyHidedContactNo =\n                \"*\".repeat(contactno.length - 4) +\n                contactno.substr(contactno.length - 4);\n            setContactNo(PartiallyHidedContactNo)\n        }\n    }\n\n    const setUserEmail = (authUser) => {\n        if (authUser && authUser.emails && authUser.emails.length > 0 && authUser.emails[0].email) {\n            let email = authUser.emails[0].email;\n            //Hide email partially\n            let len = Math.floor(email.substr(0, email.indexOf(\"@\")).length / 2)\n            let PartiallyHidedEmail = \"*\".repeat(len) + email.substr(len + 1);\n            setEmail(PartiallyHidedEmail)\n        }\n    }\n    const handleResendLink = () => {\n        setDisbaleLink(true)\n        let { method, url, baseURL } = resendOtpLink\n        axios({ method, url, baseURL }).then(({ data }) => {\n            startTimer()\n        }).catch(err => startTimer())\n    }\n    const handleOtpSubmit = (e) => {\n        e.preventDefault()\n        props.form.validateFields((error, value) => {\n            console.log(error, value);\n            if (error) {\n                return\n            }\n            setDisbaleBtn(true)\n\n            axios({ ...verifyOtp, data: { ...value, extendCheck: false } }).then(({ data }) => {\n                setDisbaleBtn(false)\n                // startTimer()\n                if (data.code === 'OK') {\n                    props.setOtpVerified(SET_OTP_VERIFIED, true)\n                    localStorage.setItem('otpVerified', JSON.stringify(true))\n                    console.log(\"TCL: handleOtpSubmit -> value\", value)\n                    if (value.extendCheck) {\n                        addUserData({ email: UtilService.getPrimaryValue(authUser.emails, \"email\") })\n                    }\n                    props.history.push({\n                        pathname: getUserBaseRedirect(props.authUser)\n                    })\n                    props.form.resetFields()\n                }\n                else {\n                    // props.userSignOut(SIGNOUT_USER_SUCCESS, () => {\n                    //     props.history.push({\n                    //         pathname: routes.login.path\n                    //     })\n                    // })\n                    Toast.error(data.message)\n                }\n            }).catch(err => {\n                // startTimer()\n                setDisbaleBtn(false)\n            })\n        });\n    }\n    const handleUserLogout = () => {\n        props.userSignOut(SIGNOUT_USER_SUCCESS);\n    }\n    return (\n        <>\n            <OtpPageUI form={props.form} timer={count}\n                email={email}\n                contactNo={contactNo}\n                onOtpSubmit={handleOtpSubmit}\n                disbaleLink={disbaleLink}\n                onResentLink={handleResendLink}\n                disbaleBtn={disbaleBtn}\n                onUserLogout={handleUserLogout}\n            />\n\n\n        </>\n    )\n}\nconst mapStateToProps = ({ auth }) => {\n    const { authUser } = auth\n    return {\n        authUser\n    }\n}\nexport default connect(mapStateToProps, { userSignOut, setOtpVerified })(createForm()(OTP));"]},"metadata":{},"sourceType":"module"}