{"ast":null,"code":"var _jsxFileName = \"/home/gauravpendherkar/DemoWriti/src/containers/User/index.js\";\nimport React, { useEffect, useState } from \"react\";\nimport { connect } from \"react-redux\";\nimport PageHead from \"./Components/Header\";\nimport { ActiveDeactive, Toast } from \"../../components/common/index\";\nimport Table from \"../../components/common/Table/index\";\nimport { USER_TYPE, MAPPED_USER_TYPE } from \"../../constants/User\";\nimport { View, Refresh1 } from \"../../assets/images/pmr/index\";\nimport { Edit } from \"../../assets/images/popup/index\";\nimport UtilService, { isModuleAccessible } from \"../../util/common\";\nimport ResetPasswordModal from \"./Components/ResetPassword\";\nimport axios from \"../../services/api/config\";\nimport routes from \"../../routes/constant\";\nimport { userPaginate, assignHomeOrPharmacy, editUser } from \"../../services/api/routes/user\";\nimport DetailViewModal from \"./Components/DetailView\";\nimport SettingModal from \"./Components/AddUser/SettingModal\";\nimport { Filters } from \"../../assets/images/resident-detail/index\";\nimport { resetPassword, changePasswordByAdmin, assignedHomelist } from \"../../services/api/routes/auth\";\nimport { isInvalidTokenError, canPerformAction } from \"../../util/common\";\nimport { reGenerateToken } from \"../../util/RegenToken\";\nimport { MODULE, ACTIONS } from \"../../constants/subscription\";\nimport Tooltip from \"rc-tooltip\";\nimport { Info } from \"../../assets/images/popup\";\nimport { da } from \"date-fns/locale\";\nimport HomeList from \"./Components/HomeList\";\nimport { pharmacyPaginate } from \"../../services/api/routes/customer\";\nimport LoginHistory from \"./Components/LoginHistory\";\nconst USER_PATHS = [\"writi-admin\", \"pharmacy\", \"organizations\", \"home\", \"home-area\"];\nconst loginUser = {\n  type: 2\n};\nconst ALL_USER_TYPES = {\n  [MAPPED_USER_TYPE[\"writi-admin\"]]: [1, 2],\n  [MAPPED_USER_TYPE[\"pharmacy\"]]: [21, 22],\n  [MAPPED_USER_TYPE[\"organizations\"]]: [3],\n  [MAPPED_USER_TYPE[\"home\"]]: [11, 12, 13, 14, 15, 16]\n};\nconst MAPPED_USER_CUSTOMER_MODULE = {\n  [MAPPED_USER_TYPE[\"writi-admin\"]]: [],\n  [MAPPED_USER_TYPE[\"pharmacy\"]]: [MODULE.USER, MODULE.PHARMACY],\n  [MAPPED_USER_TYPE[\"organizations\"]]: [MODULE.USER, MODULE.ORG_HOME],\n  [MAPPED_USER_TYPE[\"home\"]]: [MODULE.USER, MODULE.ORG_HOME]\n};\nconst MAPPED_CUSTOMER_MODULE = {\n  [MAPPED_USER_TYPE[\"writi-admin\"]]: undefined,\n  [MAPPED_USER_TYPE[\"pharmacy\"]]: MODULE.PHARMACY,\n  [MAPPED_USER_TYPE[\"organizations\"]]: MODULE.ORG_HOME,\n  [MAPPED_USER_TYPE[\"home\"]]: MODULE.ORG_HOME\n};\nconst initialFilter = {\n  page: 1,\n  limit: 10,\n  find: {},\n  sortBy: {\n    createdAt: \"DESC\"\n  },\n  populate: [{\n    pharmacyId: [\"name\"]\n  }, {\n    orgId: [\"name\"]\n  }, {\n    homeId: ['name', \"subscriptionRoleGroup\", {\n      subscriptionRoleGroup: [\"name\"]\n    }]\n  }]\n};\nconst defaultPermissions = {\n  [ACTIONS.ADD.CODE]: false,\n  [ACTIONS.LIST.CODE]: false,\n  [ACTIONS.EDIT.CODE]: false\n};\nlet searchTimeOut;\n\nfunction UserMain(props) {\n  const [total, setTotal] = useState(0);\n  const [filter, setFilter] = useState({});\n  const [btnLabel, setBtnLabel] = useState(\"\");\n  const [loading, setLoading] = useState(false);\n  const [defaultTab, setDefaultTab] = useState(1);\n  const [data, setData] = useState([]);\n  const [showDetailView, setShowDetailView] = useState(false);\n  const [userData, setUserData] = useState({});\n  const [resetPasswordModalVisible, setResetPasswordModalVisible] = useState(false);\n  const [resetPasswordId, setResetPasswordId] = useState(undefined);\n  const [userRoleOptions, setUserRoleOptions] = useState([]);\n  const [visibleSetting, setVisibleSetting] = useState(false);\n  const [permission, setPermission] = useState({ ...defaultPermissions\n  });\n  const [typeFilter, setTypeFilter] = useState(undefined);\n  const [record, setRecord] = useState(null);\n  const {\n    form,\n    location,\n    history\n  } = props;\n  const {\n    authUser,\n    homeId\n  } = props;\n  const [showHomeListModel, setShowHomeListModel] = useState(false);\n  const [homeList, setHomeList] = useState([]);\n  const [pharmacyData, setPharmacyData] = useState([]);\n  const [filterListLoading, setFilterListLoading] = useState(false);\n  const [pageName, setPageName] = useState(\"\");\n  const [loginHistory, setLoginHistory] = useState([]);\n  const [showLoginHistory, setShowLoginHistory] = useState(false);\n  useEffect(() => {\n    const paths = location.pathname.split(\"/\");\n    let label = paths[paths.length - 1];\n\n    if (USER_PATHS.indexOf(label) >= 0) {\n      setBtnLabel(label);\n      setPageName(label);\n    }\n\n    let tempFilter = { ...initialFilter\n    };\n    setTypeFilter(undefined);\n\n    if (MAPPED_USER_TYPE[label]) {\n      tempFilter.find = {\n        type: ALL_USER_TYPES[MAPPED_USER_TYPE[label]]\n      };\n      setFilter({ ...tempFilter\n      });\n      setDefaultTab(MAPPED_USER_TYPE[label]);\n      createPermissionModule(MAPPED_USER_TYPE[label]);\n    } else {\n      setFilter({ ...tempFilter\n      });\n    }\n  }, [location.pathname]);\n  useEffect(() => {\n    if (Object.keys(filter).length) {\n      if (filter.search) {\n        if (searchTimeOut) {\n          clearTimeout(searchTimeOut);\n          searchTimeOut = null;\n        }\n\n        searchTimeOut = setTimeout(() => {\n          fetch();\n        }, 600);\n      } else {\n        fetch();\n      }\n    }\n  }, [filter]);\n  useEffect(() => {\n    if (defaultTab) {\n      manageRoleOptions();\n    }\n  }, [defaultTab]);\n\n  const createPermissionModule = curTab => {\n    let result = { ...defaultPermissions\n    };\n    let permissions = {\n      [ACTIONS.ADD.CODE]: [{\n        moduleId: MODULE.USER,\n        actiontoCheck: ACTIONS.ADD.CODE\n      }, {\n        moduleId: MAPPED_CUSTOMER_MODULE[curTab],\n        actiontoCheck: ACTIONS.ADD.CODE\n      }],\n      [ACTIONS.LIST.CODE]: [{\n        moduleId: MODULE.USER,\n        actiontoCheck: ACTIONS.LIST.CODE\n      }, {\n        moduleId: MAPPED_CUSTOMER_MODULE[curTab],\n        actiontoCheck: ACTIONS.LIST.CODE\n      }],\n      [ACTIONS.EDIT.CODE]: [{\n        moduleId: MODULE.USER,\n        actiontoCheck: ACTIONS.EDIT.CODE\n      }, {\n        moduleId: MAPPED_CUSTOMER_MODULE[curTab],\n        actiontoCheck: ACTIONS.EDIT.CODE\n      }]\n    };\n    Object.keys(permissions).map(key => {\n      permissions[key].forEach(obj => {\n        if (obj.moduleId) {\n          result[key] = canPerformAction(obj);\n        } else {\n          result[key] = true;\n        }\n      });\n    });\n    setPermission(result);\n  };\n\n  const handleSearch = e => {\n    if (e.target.value) {\n      setFilter({ ...filter,\n        page: 1,\n        limit: 10,\n        search: {\n          keyword: e.target.value,\n          keys: [\"username\", \"firstName\", \"lastName\", \"emails.email\"]\n        }\n      });\n    } else {\n      if (filter.search) {\n        let tempFilter = filter;\n        delete tempFilter[\"search\"];\n        setFilter({ ...tempFilter,\n          page: 1,\n          limit: 10\n        });\n      }\n    }\n  };\n\n  const fetch = () => {\n    setLoading(true);\n    const {\n      method,\n      url,\n      baseURL\n    } = userPaginate;\n    axios({\n      method,\n      url,\n      baseURL,\n      data: {\n        // query : {...initialFilter},\n        query: { ...filter\n        },\n        withActiveHomeRolePermissions: true\n      } // ,\n      // headers: {\n      //   homeId: authUser?.homeId._id,\n      //   homeIdentifier: authUser?.homeId.homeIdentifier,\n      //   isCustom: true,\n      // },\n\n    }).then(async ({\n      data\n    }) => {\n      setLoading(false);\n      handleFetchResponse(data);\n    }).catch(async err => {\n      // if (isInvalidTokenError(err)) {\n      //     let response = await reGenerateToken({ ...userPaginate, data: { ...filter } })\n      //     if (response && response.code && response.code === 'OK') {\n      //         handleFetchResponse(response)\n      //     }\n      // }\n      setLoading(false);\n    });\n  };\n\n  const handleFetchResponse = data => {\n    if (data.code === \"OK\") {\n      setData(data.data.list);\n      setTotal(data.data.count);\n    }\n  };\n\n  const handleAdd = () => {\n    history.push({\n      pathname: routes.userAdd.path,\n      search: `?type=${btnLabel}`\n    });\n  };\n\n  const handleResetPassword = id => {\n    setResetPasswordModalVisible(true);\n    setResetPasswordId(id); // form.resetFields();\n  };\n\n  const handleSendEmail = record => {\n    axios.post(\"admin/re-send-email\", {\n      id: record.id\n    }).then(({\n      data\n    }) => {\n      if (data.code === \"OK\") {\n        Toast.success(data.message);\n      } else {\n        Toast.error(data.message);\n      }\n    }).catch(function (error) {\n      console.log(\"Error****:\", error.message);\n    });\n  };\n\n  const handleEdit = record => {\n    const paths = location.pathname.split(\"/\");\n    let label = paths[paths.length - 1];\n\n    if (USER_PATHS.indexOf(label) >= 0) {\n      history.push({\n        pathname: routes.userAdd.path,\n        search: `?id=${record._id}&type=${label}&isEdit=${true}`\n      });\n    }\n  };\n\n  const manageRoleOptions = () => {\n    let userRoleOptions = [];\n    Object.keys(USER_TYPE).forEach(key => {\n      Object.keys(USER_TYPE[key]).forEach(subkey => {\n        if (USER_TYPE[key][subkey] === defaultTab) {\n          Object.keys(USER_TYPE[key]).forEach(k => {\n            userRoleOptions.push({\n              text: k,\n              value: USER_TYPE[key][k]\n            });\n          });\n        }\n      });\n    });\n    setUserRoleOptions(userRoleOptions);\n  };\n\n  const handleDetailView = (action, data) => {\n    setShowDetailView(action);\n    setUserData(data);\n  };\n\n  const handleActiveDeactive = rec => {\n    let tempData = data.map(obj => {\n      if (obj._id === rec._id) {\n        obj.isActive = rec.isActive;\n      }\n    });\n    setData(data);\n  };\n\n  const handleHomeListPopup = (flag, record) => {\n    const {\n      url\n    } = assignedHomelist;\n    axios({ ...assignedHomelist,\n      url: `${url}/${record._id}`\n    }).then(({\n      data\n    }) => {\n      if ((data === null || data === void 0 ? void 0 : data.code) === \"OK\") {\n        setHomeList(data === null || data === void 0 ? void 0 : data.data);\n        setShowHomeListModel(true);\n      } else {\n        Toast.error(data.message);\n      }\n    }).catch(() => {\n      Toast.error(data.message);\n    });\n  };\n\n  const onHomeListClose = () => {\n    setShowHomeListModel(false);\n  };\n\n  const handleLoginHistoryPopup = record => {\n    setLoginHistory(record.loginHistory);\n    setShowLoginHistory(true);\n  };\n\n  const handleLoginHistoryPopupClose = () => {\n    setShowLoginHistory(false);\n  };\n\n  const columns = [{\n    title: \"Sr.No\",\n    keyword: \"index\",\n    dataIndex: \"index\",\n    render: (text, record, index) => (filter.page - 1) * filter.limit + (index + 1)\n  }, {\n    title: \"Name\",\n    dataIndex: \"lastName\",\n    render: (text, record) => /*#__PURE__*/React.createElement(\"span\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 382,\n        columnNumber: 9\n      }\n    }, text || \" \", \", \", record.firstName || \" \"),\n    sorter: (a, b) => a.firstName - b.firstName\n  }, {\n    title: \"Pharmacy Name\",\n    dataIndex: \"pharmacyId\",\n    render: (text, record) => /*#__PURE__*/React.createElement(\"span\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 394,\n        columnNumber: 9\n      }\n    }, text && text.name ? text.name : \" \")\n  }, {\n    title: \"User Name\",\n    dataIndex: \"username\",\n    render: (text, record) => /*#__PURE__*/React.createElement(\"span\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 400,\n        columnNumber: 33\n      }\n    }, text || \" \")\n  }, {\n    title: \"Email\",\n    dataIndex: \"emails\",\n    render: text => /*#__PURE__*/React.createElement(\"span\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 406,\n        columnNumber: 9\n      }\n    }, UtilService.getPrimaryValue(text, \"email\"))\n  }, {\n    title: \"Phone No.\",\n    dataIndex: \"mobiles\",\n    render: text => /*#__PURE__*/React.createElement(\"span\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 413,\n        columnNumber: 9\n      }\n    }, UtilService.getPrimaryValue(text, \"mobile\"))\n  }, // {\n  //     title: defaultTab === CLIENTELE_TYPE.HOME ? 'Home' : 'Home',\n  //     dataIndex: 'homeId',\n  //     className: ([USER_TYPE.ADMIN.GENERAL, USER_TYPE.ADMIN.SUPER].indexOf(defaultTab) < 0) ? (defaultTab === CLIENTELE_TYPE.HOME || defaultTab === CLIENTELE_TYPE.HOME_AREA) ? '' : 'hideColumn' : 'hideColumn',\n  //     render: (text, record) => (\n  //         <span>\n  //             {\n  //                 text && text.name ? text.name : ' '\n  //             }\n  //         </span>\n  //     )\n  // },\n  {\n    title: \"Type\",\n    dataIndex: \"type\",\n    render: (text, record) => /*#__PURE__*/React.createElement(\"span\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 432,\n        columnNumber: 9\n      }\n    }, text ? Object.keys(USER_TYPE).map(k => {\n      return Object.keys(USER_TYPE[k]).map((sk, i) => {\n        return USER_TYPE[k][sk] === text ? /*#__PURE__*/React.createElement(\"span\", {\n          key: i + \"\" + sk,\n          className: \"o_status submitted\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 437,\n            columnNumber: 19\n          }\n        }, \" \", sk.replace(/_/g, \" \")) : null;\n      });\n    }) : null) // filters:userRoleOptions,\n    // onFilter: (value, record) => record.type === value,\n\n  }, {\n    title: \"Active\",\n    dataIndex: \"isActive\",\n    render: (text, record) => /*#__PURE__*/React.createElement(\"span\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 454,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(ActiveDeactive, Object.assign({\n      record: record\n    }, record.activeDeactiveProps, {\n      isActive: record.isActive,\n      API: editUser,\n      model: \"user\",\n      documentId: record._id,\n      loginUser: authUser,\n      onActiveDeactive: handleActiveDeactive,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 455,\n        columnNumber: 11\n      }\n    }))),\n    filters: [{\n      text: \"Active\",\n      value: true\n    }, {\n      text: \"De-active\",\n      value: false\n    }],\n    onFilter: (value, record) => record.isActive === value\n  }, {\n    title: \"Action\",\n    showRefresh: true,\n    render: (text, record) => {\n      var _record$homeId, _record$homeId$subscr;\n\n      return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"actions\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 478,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        onClick: () => handleDetailView(true, record),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 479,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(View, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 480,\n          columnNumber: 15\n        }\n      }), /*#__PURE__*/React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 481,\n          columnNumber: 15\n        }\n      }, \"Info\")), authUser && [USER_TYPE.HOME.ADMIN, USER_TYPE.ADMIN.SUPER, USER_TYPE.ADMIN.GENERAL, USER_TYPE.PHARMACY.ADMIN].indexOf(authUser.type) ? /*#__PURE__*/React.createElement(\"div\", {\n        className: \"refresh\",\n        onClick: () => handleResetPassword(record.id),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 490,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(Refresh1, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 494,\n          columnNumber: 19\n        }\n      }), /*#__PURE__*/React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 495,\n          columnNumber: 19\n        }\n      }, \"Reset Pass\")) : null, /*#__PURE__*/React.createElement(\"div\", {\n        onClick: () => handleEdit(record),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 506,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(Edit, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 507,\n          columnNumber: 15\n        }\n      }), /*#__PURE__*/React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 508,\n          columnNumber: 15\n        }\n      }, \"Edit\")), [USER_TYPE.HOME.ADMIN, USER_TYPE.PHARMACY.ADMIN].includes(authUser === null || authUser === void 0 ? void 0 : authUser.type) && ![USER_TYPE.HOME.ADMIN, USER_TYPE.PHARMACY.ADMIN].includes(record.type) ? /*#__PURE__*/React.createElement(\"div\", {\n        onClick: () => handleSetting(true, record),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 517,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(Filters, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 518,\n          columnNumber: 19\n        }\n      }), /*#__PURE__*/React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 519,\n          columnNumber: 19\n        }\n      }, \" \", (record === null || record === void 0 ? void 0 : (_record$homeId = record.homeId) === null || _record$homeId === void 0 ? void 0 : (_record$homeId$subscr = _record$homeId.subscriptionRoleGroup) === null || _record$homeId$subscr === void 0 ? void 0 : _record$homeId$subscr._id) ? 'Change' : 'Assign', \" Role Permission\")) : null, authUser && [USER_TYPE.HOME.ADMIN, USER_TYPE.ADMIN.SUPER, USER_TYPE.ADMIN.GENERAL, USER_TYPE.PHARMACY.ADMIN].indexOf(authUser.type) > 0 && location.pathname === \"/user/home\" ? /*#__PURE__*/React.createElement(\"div\", {\n        onClick: () => handleHomeListPopup(true, record),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 530,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(Tooltip, {\n        overlay: \"Assigned Home List\",\n        placement: \"top\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 531,\n          columnNumber: 19\n        }\n      }, /*#__PURE__*/React.createElement(Info, {\n        style: {\n          marginTop: \"-4px\",\n          cursor: \"pointer\",\n          height: \"20px\",\n          width: \"20px\"\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 532,\n          columnNumber: 21\n        }\n      })), /*#__PURE__*/React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 542,\n          columnNumber: 19\n        }\n      }, \"Home List\")) : null, authUser && [USER_TYPE.HOME.ADMIN, USER_TYPE.ADMIN.SUPER, USER_TYPE.ADMIN.GENERAL, USER_TYPE.PHARMACY.ADMIN].indexOf(authUser.type) > 0 ? /*#__PURE__*/React.createElement(\"div\", {\n        onClick: () => handleLoginHistoryPopup(record),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 553,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(Tooltip, {\n        overlay: \"Assigned Home List\",\n        placement: \"top\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 554,\n          columnNumber: 19\n        }\n      }, /*#__PURE__*/React.createElement(Info, {\n        style: {\n          marginTop: \"-4px\",\n          cursor: \"pointer\",\n          height: \"20px\",\n          width: \"20px\"\n        },\n        onClick: () => console.log(\"\"),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 555,\n          columnNumber: 21\n        }\n      })), /*#__PURE__*/React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 565,\n          columnNumber: 19\n        }\n      }, \"Login History\")) : null));\n    }\n  }];\n\n  const getColumns = () => {\n    if (location.pathname === \"/user/pharmacy\") {\n      return columns;\n    } else {\n      return columns.filter(c => {\n        if (c.dataIndex !== \"pharmacyId\") {\n          return c;\n        }\n      });\n    }\n  };\n\n  const handleSetting = (visible, record, res) => {\n    setVisibleSetting(visible);\n    setRecord(record);\n\n    if (res) {\n      fetch();\n    }\n  };\n\n  const handleTypeFilter = val => {\n    let tempFilter = { ...filter,\n      page: 1\n    };\n    tempFilter.find = { ...tempFilter.find,\n      type: val ? [val] : ALL_USER_TYPES[defaultTab]\n    };\n    setTypeFilter(val);\n    setFilter(tempFilter);\n  };\n\n  const handleTableChange = (pagination, tfilter, sorter) => {\n    let tempFilter = filter;\n    tempFilter = { ...tempFilter,\n      page: pagination.current,\n      limit: pagination.pageSize\n    };\n\n    if (tfilter && Object.keys(tfilter).length) {\n      Object.keys(tfilter).map(k => {\n        if (tfilter[k] && tfilter[k].length > 0) {\n          tempFilter.find = { ...tempFilter.find,\n            [k]: tfilter[k]\n          };\n          tempFilter.page = pagination.current;\n        } else {\n          delete tempFilter[\"find\"][k];\n        }\n      });\n    } else {\n      tempFilter.find = {\n        type: tempFilter.find.type\n      };\n    }\n\n    setFilter(tempFilter);\n  };\n\n  const handleResetSetPassword = newPassword => {\n    if (newPassword) {\n      axios({ ...changePasswordByAdmin,\n        data: {\n          password: newPassword,\n          userId: authUser._id\n        }\n      }).then(({\n        data\n      }) => {\n        if (data.code === \"OK\") {\n          Toast.success(\"Password Updated Successfully\");\n          setResetPasswordModalVisible(false);\n        }\n      });\n    }\n  };\n\n  const handleUnassignUser = data => {\n    if (data === null || data === void 0 ? void 0 : data._id) {\n      axios({ ...assignHomeOrPharmacy,\n        data: {\n          is_assign: false,\n          homeId: data.homeId._id,\n          userId: data._id\n        }\n      }).then(({\n        data\n      }) => {\n        if (data.code === \"OK\") {\n          Toast.success(data.message);\n          setShowDetailView(false);\n          fetch();\n        }\n      }).catch(err => {\n        Toast.error(\"Something went wrong try Again \");\n      });\n    }\n  };\n\n  const handleResetPasswordCancel = () => {\n    setResetPasswordModalVisible(false);\n  };\n\n  useEffect(() => {\n    setFilterListLoading(true);\n    const pharmacyFilter = {\n      fields: [\"name\"]\n    };\n    axios({ ...pharmacyPaginate,\n      data: {\n        query: pharmacyFilter\n      }\n    }).then(data => {\n      if (data.data.code === \"OK\") {\n        setPharmacyData(data.data.data.data);\n      } else {\n        Toast.error(data.data.message);\n        setFilterListLoading(true);\n      }\n\n      setFilterListLoading(false);\n    }).catch(err => {\n      setFilterListLoading(false);\n      Toast.error(err);\n    });\n  }, []);\n\n  const onPharmacyFilterChange = pharmacyId => {\n    const tempFilter = { ...filter\n    };\n    tempFilter.find = { ...tempFilter.find,\n      pharmacyId\n    };\n    setFilter(tempFilter);\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"pmr_wrap\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 705,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 706,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(PageHead, {\n    placeholder: \"Select Pharmacy\",\n    total: total,\n    onSearch: handleSearch,\n    btnLabel: btnLabel,\n    typeFilter: typeFilter,\n    onTypeFilter: handleTypeFilter,\n    form: form,\n    defaultTab: defaultTab,\n    onAdd: handleAdd,\n    MAPPED_USER_CUSTOMER_MODULE: MAPPED_USER_CUSTOMER_MODULE,\n    loginUser: loginUser,\n    filter: filter,\n    permission: permission,\n    userRoleOptions: userRoleOptions,\n    pharmacyData: pharmacyData,\n    filterListLoading: filterListLoading,\n    onPharmacyFilterChange: onPharmacyFilterChange,\n    pageName: pageName,\n    authUser: authUser,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 707,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(Table, {\n    columns: getColumns(),\n    datasource: data,\n    loading: loading,\n    onChange: handleTableChange,\n    pagination: {\n      current: filter.page,\n      pageSize: filter.limit,\n      total: total\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 731,\n      columnNumber: 9\n    }\n  })), showDetailView ? /*#__PURE__*/React.createElement(DetailViewModal, {\n    visible: showDetailView,\n    data: userData,\n    onUnassignUser: handleUnassignUser,\n    onCancel: () => handleDetailView(false, null),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 746,\n      columnNumber: 9\n    }\n  }) : null, visibleSetting ? /*#__PURE__*/React.createElement(SettingModal, {\n    visible: visibleSetting,\n    detail: record,\n    homeId: homeId,\n    authUser: authUser,\n    onCancel: res => handleSetting(false, null, res),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 754,\n      columnNumber: 9\n    }\n  }) : null, resetPasswordModalVisible ? /*#__PURE__*/React.createElement(ResetPasswordModal, {\n    visible: resetPasswordModalVisible,\n    onCancel: handleResetPasswordCancel,\n    onResetSetPassword: handleResetSetPassword,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 763,\n      columnNumber: 9\n    }\n  }) : null, showHomeListModel && /*#__PURE__*/React.createElement(HomeList, {\n    visible: showHomeListModel,\n    data: homeList,\n    onCancel: onHomeListClose,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 770,\n      columnNumber: 9\n    }\n  }), showLoginHistory && /*#__PURE__*/React.createElement(LoginHistory, {\n    visible: showLoginHistory,\n    data: loginHistory,\n    onCancel: handleLoginHistoryPopupClose,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 777,\n      columnNumber: 9\n    }\n  }));\n}\n\nconst mapStateToProps = ({\n  auth\n}) => {\n  const {\n    authUser,\n    homeId\n  } = auth;\n  return {\n    authUser,\n    homeId\n  };\n};\n\nexport default connect(mapStateToProps)(UserMain);","map":{"version":3,"sources":["/home/gauravpendherkar/DemoWriti/src/containers/User/index.js"],"names":["React","useEffect","useState","connect","PageHead","ActiveDeactive","Toast","Table","USER_TYPE","MAPPED_USER_TYPE","View","Refresh1","Edit","UtilService","isModuleAccessible","ResetPasswordModal","axios","routes","userPaginate","assignHomeOrPharmacy","editUser","DetailViewModal","SettingModal","Filters","resetPassword","changePasswordByAdmin","assignedHomelist","isInvalidTokenError","canPerformAction","reGenerateToken","MODULE","ACTIONS","Tooltip","Info","da","HomeList","pharmacyPaginate","LoginHistory","USER_PATHS","loginUser","type","ALL_USER_TYPES","MAPPED_USER_CUSTOMER_MODULE","USER","PHARMACY","ORG_HOME","MAPPED_CUSTOMER_MODULE","undefined","initialFilter","page","limit","find","sortBy","createdAt","populate","pharmacyId","orgId","homeId","subscriptionRoleGroup","defaultPermissions","ADD","CODE","LIST","EDIT","searchTimeOut","UserMain","props","total","setTotal","filter","setFilter","btnLabel","setBtnLabel","loading","setLoading","defaultTab","setDefaultTab","data","setData","showDetailView","setShowDetailView","userData","setUserData","resetPasswordModalVisible","setResetPasswordModalVisible","resetPasswordId","setResetPasswordId","userRoleOptions","setUserRoleOptions","visibleSetting","setVisibleSetting","permission","setPermission","typeFilter","setTypeFilter","record","setRecord","form","location","history","authUser","showHomeListModel","setShowHomeListModel","homeList","setHomeList","pharmacyData","setPharmacyData","filterListLoading","setFilterListLoading","pageName","setPageName","loginHistory","setLoginHistory","showLoginHistory","setShowLoginHistory","paths","pathname","split","label","length","indexOf","tempFilter","createPermissionModule","Object","keys","search","clearTimeout","setTimeout","fetch","manageRoleOptions","curTab","result","permissions","moduleId","actiontoCheck","map","key","forEach","obj","handleSearch","e","target","value","keyword","method","url","baseURL","query","withActiveHomeRolePermissions","then","handleFetchResponse","catch","err","code","list","count","handleAdd","push","userAdd","path","handleResetPassword","id","handleSendEmail","post","success","message","error","console","log","handleEdit","_id","subkey","k","text","handleDetailView","action","handleActiveDeactive","rec","tempData","isActive","handleHomeListPopup","flag","onHomeListClose","handleLoginHistoryPopup","handleLoginHistoryPopupClose","columns","title","dataIndex","render","index","firstName","sorter","a","b","name","getPrimaryValue","sk","i","replace","activeDeactiveProps","filters","onFilter","showRefresh","HOME","ADMIN","SUPER","GENERAL","includes","handleSetting","marginTop","cursor","height","width","getColumns","c","visible","res","handleTypeFilter","val","handleTableChange","pagination","tfilter","current","pageSize","handleResetSetPassword","newPassword","password","userId","handleUnassignUser","is_assign","handleResetPasswordCancel","pharmacyFilter","fields","onPharmacyFilterChange","mapStateToProps","auth"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { connect } from \"react-redux\";\nimport PageHead from \"./Components/Header\";\nimport { ActiveDeactive, Toast } from \"../../components/common/index\";\nimport Table from \"../../components/common/Table/index\";\nimport { USER_TYPE, MAPPED_USER_TYPE } from \"../../constants/User\";\nimport { View, Refresh1 } from \"../../assets/images/pmr/index\";\nimport { Edit } from \"../../assets/images/popup/index\";\nimport UtilService, { isModuleAccessible } from \"../../util/common\";\nimport ResetPasswordModal from \"./Components/ResetPassword\";\nimport axios from \"../../services/api/config\";\nimport routes from \"../../routes/constant\";\nimport {\n  userPaginate,\n  assignHomeOrPharmacy,\n  editUser,\n} from \"../../services/api/routes/user\";\nimport DetailViewModal from \"./Components/DetailView\";\nimport SettingModal from \"./Components/AddUser/SettingModal\";\nimport { Filters } from \"../../assets/images/resident-detail/index\";\nimport {\n  resetPassword,\n  changePasswordByAdmin,\n  assignedHomelist,\n} from \"../../services/api/routes/auth\";\nimport { isInvalidTokenError, canPerformAction } from \"../../util/common\";\nimport { reGenerateToken } from \"../../util/RegenToken\";\nimport { MODULE, ACTIONS } from \"../../constants/subscription\";\nimport Tooltip from \"rc-tooltip\";\nimport { Info } from \"../../assets/images/popup\";\nimport { da } from \"date-fns/locale\";\nimport HomeList from \"./Components/HomeList\";\nimport { pharmacyPaginate } from \"../../services/api/routes/customer\";\nimport LoginHistory from \"./Components/LoginHistory\";\n\nconst USER_PATHS = [\n  \"writi-admin\",\n  \"pharmacy\",\n  \"organizations\",\n  \"home\",\n  \"home-area\",\n];\n\nconst loginUser = {\n  type: 2,\n};\n\nconst ALL_USER_TYPES = {\n  [MAPPED_USER_TYPE[\"writi-admin\"]]: [1, 2],\n  [MAPPED_USER_TYPE[\"pharmacy\"]]: [21, 22],\n  [MAPPED_USER_TYPE[\"organizations\"]]: [3],\n  [MAPPED_USER_TYPE[\"home\"]]: [11, 12, 13, 14, 15, 16],\n};\nconst MAPPED_USER_CUSTOMER_MODULE = {\n  [MAPPED_USER_TYPE[\"writi-admin\"]]: [],\n  [MAPPED_USER_TYPE[\"pharmacy\"]]: [MODULE.USER, MODULE.PHARMACY],\n  [MAPPED_USER_TYPE[\"organizations\"]]: [MODULE.USER, MODULE.ORG_HOME],\n  [MAPPED_USER_TYPE[\"home\"]]: [MODULE.USER, MODULE.ORG_HOME],\n};\n\nconst MAPPED_CUSTOMER_MODULE = {\n  [MAPPED_USER_TYPE[\"writi-admin\"]]: undefined,\n  [MAPPED_USER_TYPE[\"pharmacy\"]]: MODULE.PHARMACY,\n  [MAPPED_USER_TYPE[\"organizations\"]]: MODULE.ORG_HOME,\n  [MAPPED_USER_TYPE[\"home\"]]: MODULE.ORG_HOME,\n};\n\nconst initialFilter = {\n  page: 1,\n  limit: 10,\n  find: {},\n  sortBy: { createdAt: \"DESC\" },\n  populate: [\n    {\n      pharmacyId: [\"name\"]\n    },\n    {\n      orgId: [\"name\"],\n    },\n    {\n      homeId: ['name', \"subscriptionRoleGroup\", { subscriptionRoleGroup: [\"name\"] }],\n    },\n  ],\n};\n\nconst defaultPermissions = {\n  [ACTIONS.ADD.CODE]: false,\n  [ACTIONS.LIST.CODE]: false,\n  [ACTIONS.EDIT.CODE]: false,\n};\n\nlet searchTimeOut;\nfunction UserMain(props) {\n  const [total, setTotal] = useState(0);\n  const [filter, setFilter] = useState({});\n  const [btnLabel, setBtnLabel] = useState(\"\");\n  const [loading, setLoading] = useState(false);\n  const [defaultTab, setDefaultTab] = useState(1);\n  const [data, setData] = useState([]);\n  const [showDetailView, setShowDetailView] = useState(false);\n  const [userData, setUserData] = useState({});\n  const [resetPasswordModalVisible, setResetPasswordModalVisible] = useState(\n    false\n  );\n  const [resetPasswordId, setResetPasswordId] = useState(undefined);\n  const [userRoleOptions, setUserRoleOptions] = useState([]);\n  const [visibleSetting, setVisibleSetting] = useState(false);\n  const [permission, setPermission] = useState({ ...defaultPermissions });\n  const [typeFilter, setTypeFilter] = useState(undefined);\n  const [record, setRecord] = useState(null);\n  const { form, location, history } = props;\n  const { authUser, homeId } = props;\n  const [showHomeListModel, setShowHomeListModel] = useState(false);\n  const [homeList, setHomeList] = useState([]);\n  const [pharmacyData, setPharmacyData] = useState([]);\n  const [filterListLoading, setFilterListLoading] = useState(false);\n  const [pageName, setPageName] = useState(\"\");\n  const [loginHistory, setLoginHistory] = useState([]);\n  const [showLoginHistory, setShowLoginHistory] = useState(false);\n\n\n  useEffect(() => {\n    const paths = location.pathname.split(\"/\");\n    let label = paths[paths.length - 1];\n    if (USER_PATHS.indexOf(label) >= 0) {\n      setBtnLabel(label);\n      setPageName(label);\n    }\n    let tempFilter = {\n      ...initialFilter,\n    };\n    setTypeFilter(undefined);\n    if (MAPPED_USER_TYPE[label]) {\n      tempFilter.find = {\n        type: ALL_USER_TYPES[MAPPED_USER_TYPE[label]],\n      };\n      setFilter({ ...tempFilter });\n      setDefaultTab(MAPPED_USER_TYPE[label]);\n\n      createPermissionModule(MAPPED_USER_TYPE[label]);\n    } else {\n      setFilter({ ...tempFilter });\n    }\n  }, [location.pathname]);\n\n  useEffect(() => {\n    if (Object.keys(filter).length) {\n      if (filter.search) {\n        if (searchTimeOut) {\n          clearTimeout(searchTimeOut);\n          searchTimeOut = null;\n        }\n        searchTimeOut = setTimeout(() => {\n          fetch();\n        }, 600);\n      } else {\n        fetch();\n      }\n    }\n  }, [filter]);\n\n  useEffect(() => {\n    if (defaultTab) {\n      manageRoleOptions();\n    }\n  }, [defaultTab]);\n\n  const createPermissionModule = (curTab) => {\n    let result = { ...defaultPermissions };\n    let permissions = {\n      [ACTIONS.ADD.CODE]: [\n        {\n          moduleId: MODULE.USER,\n          actiontoCheck: ACTIONS.ADD.CODE,\n        },\n        {\n          moduleId: MAPPED_CUSTOMER_MODULE[curTab],\n          actiontoCheck: ACTIONS.ADD.CODE,\n        },\n      ],\n      [ACTIONS.LIST.CODE]: [\n        {\n          moduleId: MODULE.USER,\n          actiontoCheck: ACTIONS.LIST.CODE,\n        },\n        {\n          moduleId: MAPPED_CUSTOMER_MODULE[curTab],\n          actiontoCheck: ACTIONS.LIST.CODE,\n        },\n      ],\n      [ACTIONS.EDIT.CODE]: [\n        {\n          moduleId: MODULE.USER,\n          actiontoCheck: ACTIONS.EDIT.CODE,\n        },\n        {\n          moduleId: MAPPED_CUSTOMER_MODULE[curTab],\n          actiontoCheck: ACTIONS.EDIT.CODE,\n        },\n      ],\n    };\n    Object.keys(permissions).map((key) => {\n      permissions[key].forEach((obj) => {\n        if (obj.moduleId) {\n          result[key] = canPerformAction(obj);\n        } else {\n          result[key] = true;\n        }\n      });\n    });\n\n    setPermission(result);\n  };\n\n  const handleSearch = (e) => {\n    if (e.target.value) {\n      setFilter({\n        ...filter,\n        page: 1,\n        limit: 10,\n        search: {\n          keyword: e.target.value,\n          keys: [\"username\", \"firstName\", \"lastName\", \"emails.email\"],\n        },\n      });\n    } else {\n      if (filter.search) {\n        let tempFilter = filter;\n        delete tempFilter[\"search\"];\n        setFilter({ ...tempFilter, page: 1, limit: 10 });\n      }\n    }\n  };\n  const fetch = () => {\n    setLoading(true);\n    const { method, url, baseURL } = userPaginate;\n    axios({\n      method,\n      url,\n      baseURL,\n      data: {\n        // query : {...initialFilter},\n        query: { ...filter },\n        withActiveHomeRolePermissions: true,\n      }\n      // ,\n      // headers: {\n      //   homeId: authUser?.homeId._id,\n      //   homeIdentifier: authUser?.homeId.homeIdentifier,\n      //   isCustom: true,\n      // },\n    })\n      .then(async ({ data }) => {\n        setLoading(false);\n        handleFetchResponse(data);\n      })\n      .catch(async (err) => {\n        // if (isInvalidTokenError(err)) {\n        //     let response = await reGenerateToken({ ...userPaginate, data: { ...filter } })\n        //     if (response && response.code && response.code === 'OK') {\n        //         handleFetchResponse(response)\n        //     }\n        // }\n        setLoading(false);\n      });\n  };\n  const handleFetchResponse = (data) => {\n    if (data.code === \"OK\") {\n      setData(data.data.list);\n      setTotal(data.data.count);\n    }\n  };\n  const handleAdd = () => {\n    history.push({\n      pathname: routes.userAdd.path,\n      search: `?type=${btnLabel}`,\n    });\n  };\n  const handleResetPassword = (id) => {\n    setResetPasswordModalVisible(true);\n    setResetPasswordId(id);\n    // form.resetFields();\n  };\n  const handleSendEmail = (record) => {\n    axios\n      .post(\"admin/re-send-email\", { id: record.id })\n      .then(({ data }) => {\n        if (data.code === \"OK\") {\n          Toast.success(data.message);\n        } else {\n          Toast.error(data.message);\n        }\n      })\n      .catch(function (error) {\n        console.log(\"Error****:\", error.message);\n      });\n  };\n\n  const handleEdit = (record) => {\n    const paths = location.pathname.split(\"/\");\n    let label = paths[paths.length - 1];\n    if (USER_PATHS.indexOf(label) >= 0) {\n      history.push({\n        pathname: routes.userAdd.path,\n        search: `?id=${record._id}&type=${label}&isEdit=${true}`,\n      });\n    }\n  };\n  const manageRoleOptions = () => {\n    let userRoleOptions = [];\n    Object.keys(USER_TYPE).forEach((key) => {\n      Object.keys(USER_TYPE[key]).forEach((subkey) => {\n        if (USER_TYPE[key][subkey] === defaultTab) {\n          Object.keys(USER_TYPE[key]).forEach((k) => {\n            userRoleOptions.push({ text: k, value: USER_TYPE[key][k] });\n          });\n        }\n      });\n    });\n    setUserRoleOptions(userRoleOptions);\n  };\n\n  const handleDetailView = (action, data) => {\n    setShowDetailView(action);\n    setUserData(data);\n  };\n  const handleActiveDeactive = (rec) => {\n    let tempData = data.map((obj) => {\n      if (obj._id === rec._id) {\n        obj.isActive = rec.isActive;\n      }\n    });\n    setData(data);\n  };\n\n  const handleHomeListPopup = (flag, record) => {\n    const { url } = assignedHomelist;\n    axios({\n      ...assignedHomelist,\n      url: `${url}/${record._id}`,\n    })\n      .then(({ data }) => {\n        if (data?.code === \"OK\") {\n          setHomeList(data?.data);\n          setShowHomeListModel(true);\n        } else {\n          Toast.error(data.message);\n        }\n      })\n      .catch(() => {\n        Toast.error(data.message);\n      });\n  };\n  const onHomeListClose = () => {\n    setShowHomeListModel(false);\n  };\n\n  const handleLoginHistoryPopup = (record) => {\n    setLoginHistory(record.loginHistory);\n    setShowLoginHistory(true);\n  };\n\n  const handleLoginHistoryPopupClose = () => {\n    setShowLoginHistory(false);\n  };\n\n\n\n\n  const columns = [\n    {\n      title: \"Sr.No\",\n      keyword: \"index\",\n      dataIndex: \"index\",\n      render: (text, record, index) =>\n        (filter.page - 1) * filter.limit + (index + 1),\n    },\n    {\n      title: \"Name\",\n      dataIndex: \"lastName\",\n      render: (text, record) => (\n        <span>\n          {text || \" \"}\n          {\", \"}\n          {record.firstName || \" \"}\n        </span>\n      ),\n      sorter: (a, b) => a.firstName - b.firstName,\n    },\n    {\n      title: \"Pharmacy Name\",\n      dataIndex: \"pharmacyId\",\n      render: (text, record) => (\n        <span>{text && text.name ? text.name : \" \"}</span>\n      ),\n    },\n    {\n      title: \"User Name\",\n      dataIndex: \"username\",\n      render: (text, record) => <span>{text || \" \"}</span>,\n    },\n    {\n      title: \"Email\",\n      dataIndex: \"emails\",\n      render: (text) => (\n        <span>{UtilService.getPrimaryValue(text, \"email\")}</span>\n      ),\n    },\n    {\n      title: \"Phone No.\",\n      dataIndex: \"mobiles\",\n      render: (text) => (\n        <span>{UtilService.getPrimaryValue(text, \"mobile\")}</span>\n      ),\n    },\n    // {\n    //     title: defaultTab === CLIENTELE_TYPE.HOME ? 'Home' : 'Home',\n    //     dataIndex: 'homeId',\n    //     className: ([USER_TYPE.ADMIN.GENERAL, USER_TYPE.ADMIN.SUPER].indexOf(defaultTab) < 0) ? (defaultTab === CLIENTELE_TYPE.HOME || defaultTab === CLIENTELE_TYPE.HOME_AREA) ? '' : 'hideColumn' : 'hideColumn',\n    //     render: (text, record) => (\n    //         <span>\n    //             {\n    //                 text && text.name ? text.name : ' '\n    //             }\n    //         </span>\n    //     )\n    // },\n    {\n      title: \"Type\",\n      dataIndex: \"type\",\n      render: (text, record) => (\n        <span>\n          {text\n            ? Object.keys(USER_TYPE).map((k) => {\n              return Object.keys(USER_TYPE[k]).map((sk, i) => {\n                return USER_TYPE[k][sk] === text ? (\n                  <span key={i + \"\" + sk} className=\"o_status submitted\">\n                    {\" \"}\n                    {sk.replace(/_/g, \" \")}\n                  </span>\n                ) : null;\n              });\n            })\n            : null}\n        </span>\n      ),\n      // filters:userRoleOptions,\n      // onFilter: (value, record) => record.type === value,\n    },\n    {\n      title: \"Active\",\n      dataIndex: \"isActive\",\n      render: (text, record) => (\n        <span>\n          <ActiveDeactive\n            record={record}\n            {...record.activeDeactiveProps}\n            isActive={record.isActive}\n            API={editUser}\n            model=\"user\"\n            documentId={record._id}\n            loginUser={authUser}\n            onActiveDeactive={handleActiveDeactive}\n          />\n        </span>\n      ),\n      filters: [\n        { text: \"Active\", value: true },\n        { text: \"De-active\", value: false },\n      ],\n      onFilter: (value, record) => record.isActive === value,\n    },\n    {\n      title: \"Action\",\n      showRefresh: true,\n      render: (text, record) => (\n        <>\n          <div className=\"actions\">\n            <div onClick={() => handleDetailView(true, record)}>\n              <View />\n              <p>Info</p>\n            </div>\n            {authUser &&\n              [\n                USER_TYPE.HOME.ADMIN,\n                USER_TYPE.ADMIN.SUPER,\n                USER_TYPE.ADMIN.GENERAL,\n                USER_TYPE.PHARMACY.ADMIN,\n              ].indexOf(authUser.type) ? (\n                <div\n                  className=\"refresh\"\n                  onClick={() => handleResetPassword(record.id)}\n                >\n                  <Refresh1 />\n                  <p>Reset Pass</p>\n                </div>\n              ) : null}\n            {/* {\n                            isModuleAccessible(MAPPED_USER_CUSTOMER_MODULE[defaultTab], true) &&\n                                permission[ACTIONS.EDIT.CODE] ?\n                                <div onClick={() => handleEdit(record)}>\n                                    <Edit />\n                                    <p>Edit</p>\n                                </div> : null\n                        } */}\n            <div onClick={() => handleEdit(record)}>\n              <Edit />\n              <p>Edit</p>\n            </div>\n\n            {[USER_TYPE.HOME.ADMIN, USER_TYPE.PHARMACY.ADMIN].includes(\n              authUser?.type\n            ) &&\n              ![USER_TYPE.HOME.ADMIN, USER_TYPE.PHARMACY.ADMIN].includes(\n                record.type\n              ) ? (\n                <div onClick={() => handleSetting(true, record)}>\n                  <Filters />\n                  <p> {record?.homeId?.subscriptionRoleGroup?._id ? 'Change' : 'Assign'} Role Permission</p>\n                </div>\n              ) : null}\n\n            {(authUser &&\n              [\n                USER_TYPE.HOME.ADMIN,\n                USER_TYPE.ADMIN.SUPER,\n                USER_TYPE.ADMIN.GENERAL,\n                USER_TYPE.PHARMACY.ADMIN,\n              ].indexOf(authUser.type) > 0 && location.pathname === \"/user/home\" ) ? (\n                <div onClick={() => handleHomeListPopup(true, record)}>\n                  <Tooltip overlay={\"Assigned Home List\"} placement=\"top\">\n                    <Info\n                      style={{\n                        marginTop: \"-4px\",\n                        cursor: \"pointer\",\n                        height: \"20px\",\n                        width: \"20px\",\n                      }}\n                      \n                    />\n                  </Tooltip>\n                  <p>Home List</p>\n                </div>\n              ) : null}\n\n            {authUser &&\n              [\n                USER_TYPE.HOME.ADMIN,\n                USER_TYPE.ADMIN.SUPER,\n                USER_TYPE.ADMIN.GENERAL,\n                USER_TYPE.PHARMACY.ADMIN,\n              ].indexOf(authUser.type) > 0 ? (\n                <div onClick={() => handleLoginHistoryPopup(record)}>\n                  <Tooltip overlay={\"Assigned Home List\"} placement=\"top\">\n                    <Info\n                      style={{\n                        marginTop: \"-4px\",\n                        cursor: \"pointer\",\n                        height: \"20px\",\n                        width: \"20px\",\n                      }}\n                      onClick={() => console.log(\"\")}\n                    />\n                  </Tooltip>\n                  <p>Login History</p>\n                </div>\n              ) : null}\n\n            {/* <div onClick={() => test(record)}>\n                            <Edit />\n                            <p>Mail</p>\n                        </div> */}\n          </div>\n        </>\n      ),\n    },\n  ];\n  const getColumns = () => {\n    if (location.pathname === \"/user/pharmacy\") {\n      return columns;\n    } else {\n      return columns.filter((c) => {\n        if (c.dataIndex !== \"pharmacyId\") {\n          return c;\n        }\n      });\n    }\n  };\n\n  const handleSetting = (visible, record, res) => {\n    setVisibleSetting(visible);\n    setRecord(record);\n    if (res) {\n      fetch();\n    }\n  };\n\n  const handleTypeFilter = (val) => {\n    let tempFilter = {\n      ...filter,\n      page: 1,\n    };\n    tempFilter.find = {\n      ...tempFilter.find,\n      type: val ? [val] : ALL_USER_TYPES[defaultTab],\n    };\n    setTypeFilter(val);\n    setFilter(tempFilter);\n  };\n  const handleTableChange = (pagination, tfilter, sorter) => {\n    let tempFilter = filter;\n    tempFilter = {\n      ...tempFilter,\n      page: pagination.current,\n      limit: pagination.pageSize,\n    };\n    if (tfilter && Object.keys(tfilter).length) {\n      Object.keys(tfilter).map((k) => {\n        if (tfilter[k] && tfilter[k].length > 0) {\n          tempFilter.find = {\n            ...tempFilter.find,\n            [k]: tfilter[k],\n          };\n          tempFilter.page = pagination.current;\n        } else {\n          delete tempFilter[\"find\"][k];\n        }\n      });\n    } else {\n      tempFilter.find = {\n        type: tempFilter.find.type,\n      };\n    }\n    setFilter(tempFilter);\n  };\n  const handleResetSetPassword = (newPassword) => {\n    if (newPassword) {\n      axios({\n        ...changePasswordByAdmin,\n        data: {\n          password: newPassword,\n          userId: authUser._id,\n        },\n      }).then(({ data }) => {\n        if (data.code === \"OK\") {\n          Toast.success(\"Password Updated Successfully\");\n          setResetPasswordModalVisible(false);\n        }\n      });\n    }\n  };\n\n  const handleUnassignUser = (data) => {\n    if (data?._id) {\n      axios({\n        ...assignHomeOrPharmacy,\n        data: {\n          is_assign: false,\n          homeId: data.homeId._id,\n          userId: data._id,\n        },\n      })\n        .then(({ data }) => {\n          if (data.code === \"OK\") {\n            Toast.success(data.message);\n            setShowDetailView(false);\n            fetch();\n          }\n        })\n        .catch((err) => {\n          Toast.error(\"Something went wrong try Again \");\n        });\n    }\n  };\n\n  const handleResetPasswordCancel = () => {\n    setResetPasswordModalVisible(false);\n  };\n  useEffect(() => {\n    setFilterListLoading(true);\n    const pharmacyFilter = {\n      fields: [\"name\"],\n    };\n    axios({ ...pharmacyPaginate, data: { query: pharmacyFilter } })\n      .then((data) => {\n        if (data.data.code === \"OK\") {\n          setPharmacyData(data.data.data.data);\n        } else {\n          Toast.error(data.data.message);\n          setFilterListLoading(true);\n        }\n        setFilterListLoading(false);\n      })\n      .catch((err) => {\n        setFilterListLoading(false);\n        Toast.error(err);\n      });\n  }, []);\n  const onPharmacyFilterChange = (pharmacyId) => {\n    const tempFilter = { ...filter };\n    tempFilter.find = { ...tempFilter.find, pharmacyId };\n    setFilter(tempFilter);\n  };\n  return (\n    <div className=\"pmr_wrap\">\n      <div className=\"container\">\n        <PageHead\n          placeholder={\"Select Pharmacy\"}\n          total={total}\n          onSearch={handleSearch}\n          btnLabel={btnLabel}\n          typeFilter={typeFilter}\n          onTypeFilter={handleTypeFilter}\n          form={form}\n          defaultTab={defaultTab}\n          onAdd={handleAdd}\n          MAPPED_USER_CUSTOMER_MODULE={MAPPED_USER_CUSTOMER_MODULE}\n          loginUser={loginUser}\n          filter={filter}\n          permission={permission}\n          userRoleOptions={userRoleOptions}\n          pharmacyData={pharmacyData}\n          filterListLoading={filterListLoading}\n          onPharmacyFilterChange={onPharmacyFilterChange}\n          pageName={pageName}\n          authUser={authUser}\n        />\n        {/* {\n                isModuleAccessible(MAPPED_USER_CUSTOMER_MODULE[defaultTab], true) &&\n                    permission[ACTIONS.LIST.CODE] ? */}\n        <Table\n          columns={getColumns()}\n          datasource={data}\n          loading={loading}\n          onChange={handleTableChange}\n          pagination={{\n            current: filter.page,\n            pageSize: filter.limit,\n            total: total,\n          }}\n        />\n        {/* : null\n            } */}\n      </div>\n      {showDetailView ? (\n        <DetailViewModal\n          visible={showDetailView}\n          data={userData}\n          onUnassignUser={handleUnassignUser}\n          onCancel={() => handleDetailView(false, null)}\n        />\n      ) : null}\n      {visibleSetting ? (\n        <SettingModal\n          visible={visibleSetting}\n          detail={record}\n          homeId={homeId}\n          authUser={authUser}\n          onCancel={(res) => handleSetting(false, null, res)}\n        />\n      ) : null}\n      {resetPasswordModalVisible ? (\n        <ResetPasswordModal\n          visible={resetPasswordModalVisible}\n          onCancel={handleResetPasswordCancel}\n          onResetSetPassword={handleResetSetPassword}\n        />\n      ) : null}\n      {showHomeListModel && (\n        <HomeList\n          visible={showHomeListModel}\n          data={homeList}\n          onCancel={onHomeListClose}\n        />\n      )}\n      {showLoginHistory && (\n        <LoginHistory\n          visible={showLoginHistory}\n          data={loginHistory}\n          onCancel={handleLoginHistoryPopupClose}\n        />\n      )}\n    </div>\n  );\n}\nconst mapStateToProps = ({ auth }) => {\n  const { authUser, homeId } = auth;\n  return {\n    authUser,\n    homeId,\n  };\n};\nexport default connect(mapStateToProps)(UserMain);\n"]},"metadata":{},"sourceType":"module"}