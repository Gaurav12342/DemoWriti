{"ast":null,"code":"var _jsxFileName = \"/home/gauravpendherkar/DemoWriti/src/containers/MenuBar/MenuBar.js\";\nimport React, { useState, useEffect, useMemo } from 'react';\nimport { LogoW } from '../../assets/images/index';\nimport { Link } from 'react-router-dom';\nimport { MENU } from '../../constants/Menu';\nimport { isModuleAccessible, canPerformAction } from '../../util/common';\nimport { connect } from 'react-redux';\nimport { USER_TYPE, isAdminUser } from '../../constants/User';\nimport { ReactComponent as MoreArrow } from \"@svgr/webpack?-svgo,+titleProp,+ref!../../assets/images/more-arrow.svg\";\nimport { ACTIONS } from '../../constants/subscription';\n\nconst _ = require('lodash');\n\nconst menuCount = 7;\n\nfunction MenuBar(props) {\n  const {\n    authUser\n  } = props;\n  const [filteredMenus, setFilteredMenus] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const tenantId = useMemo(() => {\n    return localStorage.getItem('tenantId');\n  }, [localStorage.getItem('tenantId')]);\n  useEffect(() => {\n    let tempFilMenu = _.cloneDeep(MENU).filter(curMenu => {\n      if (curMenu && curMenu.visibilty) {\n        curMenu.shallRender = checkPermission(curMenu);\n\n        if (curMenu.children && curMenu.children.length) {\n          curMenu.children = curMenu.children.filter(subMenu => {\n            subMenu.shallRender = checkPermission(subMenu);\n            if (subMenu.shallRender) return subMenu;\n          });\n        }\n      }\n\n      if (curMenu.shallRender) return curMenu;\n    });\n\n    setFilteredMenus(tempFilMenu);\n\n    if (loading) {\n      setLoading(false);\n    }\n  }, [tenantId]);\n\n  const checkPermission = menu => {\n    let isSuperGenAdmin = [USER_TYPE.ADMIN.SUPER, USER_TYPE.ADMIN.GENERAL].indexOf(authUser.type) >= 0;\n    let shallShow = false;\n\n    if (menu) {\n      if (isSuperGenAdmin && menu.hasOwnProperty(\"excludeGenAdmin\") && menu.excludeGenAdmin) {\n        shallShow = false;\n      } else if ([USER_TYPE.PHARMACY.ADMIN, USER_TYPE.HOME.ADMIN].indexOf(authUser.type) >= 0 && menu.hasOwnProperty('excludePharHomeAdmin') && menu.excludePharHomeAdmin) {\n        shallShow = false;\n      } else if (isSuperGenAdmin) {\n        shallShow = true;\n      } else if (menu.module) {\n        shallShow = isModuleAccessible(menu.module, false, menu.subModule);\n\n        if (menu.subModule && !isAdminUser(authUser.type)) {\n          shallShow = canPerformAction({\n            moduleId: menu.module,\n            subModuleId: menu.subModule,\n            checkSubAction: ACTIONS.LIST.CODE\n          });\n        }\n      } else if (menu.children && menu.children.length) {\n        let ans = menu.children.some(subMenu => {\n          if (subMenu.hasOwnProperty('showDefault') && subMenu.showDefault && isSuperGenAdmin) {\n            return true;\n          }\n\n          if (checkPermission(subMenu)) {\n            return true;\n          }\n        });\n        shallShow = ans;\n      }\n    }\n\n    return shallShow;\n  };\n\n  function RenderMenuList(menuArr) {\n    return menuArr.map(menu => {\n      if (menu.visibilty) {\n        if (menu.children && menu.children.length) {\n          return /*#__PURE__*/React.createElement(\"li\", {\n            key: menu.id,\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 84,\n              columnNumber: 28\n            }\n          }, /*#__PURE__*/React.createElement(\"a\", {\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 85,\n              columnNumber: 25\n            }\n          }, menu.name, \" \"), /*#__PURE__*/React.createElement(\"ul\", {\n            className: \"submenu\",\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 86,\n              columnNumber: 25\n            }\n          }, /*#__PURE__*/React.createElement(\"li\", {\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 87,\n              columnNumber: 29\n            }\n          }, menu.children.map(subMenu => {\n            return subMenu.hasOwnProperty('isPublic') && !subMenu.isPublic ? null : /*#__PURE__*/React.createElement(Link, {\n              key: subMenu.id,\n              to: subMenu.path,\n              __self: this,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 91,\n                columnNumber: 45\n              }\n            }, subMenu.name);\n          }))));\n        } else {\n          return /*#__PURE__*/React.createElement(\"li\", {\n            key: menu.id,\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 99,\n              columnNumber: 28\n            }\n          }, /*#__PURE__*/React.createElement(Link, {\n            to: menu.path,\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 100,\n              columnNumber: 25\n            }\n          }, menu.name));\n        }\n      }\n    });\n  }\n\n  function RenderMenu(filteredMenu) {\n    // console.log(\"RenderMenu -> filteredMenu\", filteredMenu)\n    let showMenus = [...filteredMenu],\n        showDropMenu = [];\n\n    if (filteredMenu.length > menuCount) {\n      showMenus = filteredMenu.slice(0, menuCount); // console.log(\"RenderMenu -> showMenus\", showMenus)\n\n      showDropMenu = filteredMenu.slice(menuCount, filteredMenu.length); // console.log(\"RenderMenu -> showDropMenu\", showDropMenu)\n    }\n\n    return /*#__PURE__*/React.createElement(React.Fragment, null, RenderMenuList(showMenus), showDropMenu.length > 0 ? /*#__PURE__*/React.createElement(\"li\", {\n      className: \"more-h-menu\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"a\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 121,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(MoreArrow, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 121,\n        columnNumber: 28\n      }\n    })), /*#__PURE__*/React.createElement(\"ul\", {\n      className: \"submenu\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 122,\n        columnNumber: 25\n      }\n    }, showDropMenu.map(menu => {\n      const isChildExist = menu.children && menu.children.length > 0;\n      return /*#__PURE__*/React.createElement(\"li\", {\n        className: isChildExist ? \"has-child\" : \"\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 126,\n          columnNumber: 44\n        }\n      }, /*#__PURE__*/React.createElement(Link, {\n        to: menu.path,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 127,\n          columnNumber: 41\n        }\n      }, menu.name), isChildExist ? /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"ul\", {\n        className: \"sub-child-menu\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 130,\n          columnNumber: 49\n        }\n      }, menu.children.map(subMenu => {\n        return /*#__PURE__*/React.createElement(\"li\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 133,\n            columnNumber: 68\n          }\n        }, /*#__PURE__*/React.createElement(Link, {\n          key: subMenu.id,\n          to: subMenu.path,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 134,\n            columnNumber: 65\n          }\n        }, subMenu.name));\n      }))) : null);\n    }))) : null);\n  }\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"menu\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 149,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"h_logo\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(LogoW, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"nav_link_wrap\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"ul\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 154,\n      columnNumber: 13\n    }\n  }, filteredMenus && filteredMenus.length > 0 ? RenderMenu(filteredMenus) : null // <Spin spinning={true} />\n  )));\n}\n\nconst mapStateToProps = ({\n  auth\n}) => {\n  const {\n    authUser\n  } = auth;\n  return {\n    authUser\n  };\n};\n\nexport default connect(mapStateToProps)(MenuBar);","map":{"version":3,"sources":["/home/gauravpendherkar/DemoWriti/src/containers/MenuBar/MenuBar.js"],"names":["React","useState","useEffect","useMemo","LogoW","Link","MENU","isModuleAccessible","canPerformAction","connect","USER_TYPE","isAdminUser","ACTIONS","_","require","menuCount","MenuBar","props","authUser","filteredMenus","setFilteredMenus","loading","setLoading","tenantId","localStorage","getItem","tempFilMenu","cloneDeep","filter","curMenu","visibilty","shallRender","checkPermission","children","length","subMenu","menu","isSuperGenAdmin","ADMIN","SUPER","GENERAL","indexOf","type","shallShow","hasOwnProperty","excludeGenAdmin","PHARMACY","HOME","excludePharHomeAdmin","module","subModule","moduleId","subModuleId","checkSubAction","LIST","CODE","ans","some","showDefault","RenderMenuList","menuArr","map","id","name","isPublic","path","RenderMenu","filteredMenu","showMenus","showDropMenu","slice","isChildExist","mapStateToProps","auth"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,QAAhB,EAA0BC,SAA1B,EAAqCC,OAArC,QAAoD,OAApD;AACA,SAASC,KAAT,QAAsB,2BAAtB;AACA,SAASC,IAAT,QAAqB,kBAArB;AACA,SAASC,IAAT,QAAqB,sBAArB;AACA,SAASC,kBAAT,EAA6BC,gBAA7B,QAAqD,mBAArD;AACA,SAASC,OAAT,QAAwB,aAAxB;AACA,SAASC,SAAT,EAAoBC,WAApB,QAAuC,sBAAvC;;AAEA,SAASC,OAAT,QAAwB,8BAAxB;;AACA,MAAMC,CAAC,GAAGC,OAAO,CAAC,QAAD,CAAjB;;AAEA,MAAMC,SAAS,GAAG,CAAlB;;AACA,SAASC,OAAT,CAAiBC,KAAjB,EAAwB;AAEpB,QAAM;AAAEC,IAAAA;AAAF,MAAeD,KAArB;AACA,QAAM,CAACE,aAAD,EAAgBC,gBAAhB,IAAoCnB,QAAQ,CAAC,EAAD,CAAlD;AACA,QAAM,CAACoB,OAAD,EAAUC,UAAV,IAAwBrB,QAAQ,CAAC,IAAD,CAAtC;AACA,QAAMsB,QAAQ,GAAGpB,OAAO,CAAC,MAAM;AAC3B,WAAOqB,YAAY,CAACC,OAAb,CAAqB,UAArB,CAAP;AACH,GAFuB,EAErB,CAACD,YAAY,CAACC,OAAb,CAAqB,UAArB,CAAD,CAFqB,CAAxB;AAIAvB,EAAAA,SAAS,CAAC,MAAM;AACZ,QAAIwB,WAAW,GAAGb,CAAC,CAACc,SAAF,CAAYrB,IAAZ,EAAkBsB,MAAlB,CAAyBC,OAAO,IAAI;AAClD,UAAIA,OAAO,IAAIA,OAAO,CAACC,SAAvB,EAAkC;AAC9BD,QAAAA,OAAO,CAACE,WAAR,GAAsBC,eAAe,CAACH,OAAD,CAArC;;AAEA,YAAIA,OAAO,CAACI,QAAR,IAAoBJ,OAAO,CAACI,QAAR,CAAiBC,MAAzC,EAAiD;AAC7CL,UAAAA,OAAO,CAACI,QAAR,GAAmBJ,OAAO,CAACI,QAAR,CAAiBL,MAAjB,CAAwBO,OAAO,IAAI;AAClDA,YAAAA,OAAO,CAACJ,WAAR,GAAsBC,eAAe,CAACG,OAAD,CAArC;AACA,gBAAIA,OAAO,CAACJ,WAAZ,EACI,OAAOI,OAAP;AACP,WAJkB,CAAnB;AAKH;AACJ;;AACD,UAAIN,OAAO,CAACE,WAAZ,EACI,OAAOF,OAAP;AACP,KAdiB,CAAlB;;AAeAT,IAAAA,gBAAgB,CAACM,WAAD,CAAhB;;AACA,QAAIL,OAAJ,EAAa;AACTC,MAAAA,UAAU,CAAC,KAAD,CAAV;AACH;AACJ,GApBQ,EAoBN,CAACC,QAAD,CApBM,CAAT;;AAqBA,QAAMS,eAAe,GAAII,IAAD,IAAU;AAC9B,QAAIC,eAAe,GAAG,CAAC3B,SAAS,CAAC4B,KAAV,CAAgBC,KAAjB,EAAwB7B,SAAS,CAAC4B,KAAV,CAAgBE,OAAxC,EAAiDC,OAAjD,CAAyDvB,QAAQ,CAACwB,IAAlE,KAA2E,CAAjG;AACA,QAAIC,SAAS,GAAG,KAAhB;;AACA,QAAIP,IAAJ,EAAU;AACN,UAAIC,eAAe,IAAKD,IAAI,CAACQ,cAAL,CAAoB,iBAApB,KAA0CR,IAAI,CAACS,eAAvE,EAAyF;AACrFF,QAAAA,SAAS,GAAG,KAAZ;AACH,OAFD,MAEO,IAAI,CAACjC,SAAS,CAACoC,QAAV,CAAmBR,KAApB,EAA2B5B,SAAS,CAACqC,IAAV,CAAeT,KAA1C,EAAiDG,OAAjD,CAAyDvB,QAAQ,CAACwB,IAAlE,KAA2E,CAA3E,IAAiFN,IAAI,CAACQ,cAAL,CAAoB,sBAApB,KAA+CR,IAAI,CAACY,oBAAzI,EAAgK;AACnKL,QAAAA,SAAS,GAAG,KAAZ;AACH,OAFM,MAGF,IAAIN,eAAJ,EAAqB;AACtBM,QAAAA,SAAS,GAAG,IAAZ;AACH,OAFI,MAGA,IAAIP,IAAI,CAACa,MAAT,EAAiB;AAClBN,QAAAA,SAAS,GAAGpC,kBAAkB,CAAC6B,IAAI,CAACa,MAAN,EAAc,KAAd,EAAqBb,IAAI,CAACc,SAA1B,CAA9B;;AACA,YAAId,IAAI,CAACc,SAAL,IAAkB,CAACvC,WAAW,CAACO,QAAQ,CAACwB,IAAV,CAAlC,EAAmD;AAC/CC,UAAAA,SAAS,GAAGnC,gBAAgB,CAAC;AACzB2C,YAAAA,QAAQ,EAAEf,IAAI,CAACa,MADU;AAEzBG,YAAAA,WAAW,EAAEhB,IAAI,CAACc,SAFO;AAGzBG,YAAAA,cAAc,EAAEzC,OAAO,CAAC0C,IAAR,CAAaC;AAHJ,WAAD,CAA5B;AAKH;AACJ,OATI,MAUA,IAAInB,IAAI,CAACH,QAAL,IAAiBG,IAAI,CAACH,QAAL,CAAcC,MAAnC,EAA2C;AAC5C,YAAIsB,GAAG,GAAGpB,IAAI,CAACH,QAAL,CAAcwB,IAAd,CAAmBtB,OAAO,IAAI;AACpC,cAAKA,OAAO,CAACS,cAAR,CAAuB,aAAvB,KAAyCT,OAAO,CAACuB,WAAlD,IAAkErB,eAAtE,EAAuF;AACnF,mBAAO,IAAP;AACH;;AACD,cAAIL,eAAe,CAACG,OAAD,CAAnB,EAA8B;AAC1B,mBAAO,IAAP;AACH;AACJ,SAPS,CAAV;AAQAQ,QAAAA,SAAS,GAAGa,GAAZ;AACH;AACJ;;AACD,WAAOb,SAAP;AACH,GAnCD;;AAqCA,WAASgB,cAAT,CAAwBC,OAAxB,EAAiC;AAC7B,WAAOA,OAAO,CAACC,GAAR,CAAYzB,IAAI,IAAI;AACvB,UAAIA,IAAI,CAACN,SAAT,EAAoB;AAChB,YAAIM,IAAI,CAACH,QAAL,IAAiBG,IAAI,CAACH,QAAL,CAAcC,MAAnC,EAA2C;AACvC,8BAAO;AAAK,YAAA,GAAG,EAAEE,IAAI,CAAC0B,EAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0BACH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aAAI1B,IAAI,CAAC2B,IAAT,MADG,eAEH;AAAI,YAAA,SAAS,EAAC,SAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0BACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aAEQ3B,IAAI,CAACH,QAAL,CAAc4B,GAAd,CAAkB1B,OAAO,IAAI;AACzB,mBAAQA,OAAO,CAACS,cAAR,CAAuB,UAAvB,KAAsC,CAACT,OAAO,CAAC6B,QAAhD,GAA4D,IAA5D,gBACH,oBAAC,IAAD;AAAM,cAAA,GAAG,EAAE7B,OAAO,CAAC2B,EAAnB;AAAuB,cAAA,EAAE,EAAE3B,OAAO,CAAC8B,IAAnC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eAA2C9B,OAAO,CAAC4B,IAAnD,CADJ;AAEH,WAHD,CAFR,CADJ,CAFG,CAAP;AAaH,SAdD,MAeK;AACD,8BAAO;AAAI,YAAA,GAAG,EAAE3B,IAAI,CAAC0B,EAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0BACH,oBAAC,IAAD;AAAM,YAAA,EAAE,EAAE1B,IAAI,CAAC6B,IAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aAAuB7B,IAAI,CAAC2B,IAA5B,CADG,CAAP;AAGH;AACJ;AACJ,KAvBM,CAAP;AAwBH;;AAED,WAASG,UAAT,CAAoBC,YAApB,EAAkC;AAC9B;AACA,QAAIC,SAAS,GAAG,CAAC,GAAGD,YAAJ,CAAhB;AAAA,QAAmCE,YAAY,GAAG,EAAlD;;AACA,QAAIF,YAAY,CAACjC,MAAb,GAAsBnB,SAA1B,EAAqC;AACjCqD,MAAAA,SAAS,GAAGD,YAAY,CAACG,KAAb,CAAmB,CAAnB,EAAsBvD,SAAtB,CAAZ,CADiC,CAEjC;;AACAsD,MAAAA,YAAY,GAAGF,YAAY,CAACG,KAAb,CAAmBvD,SAAnB,EAA8BoD,YAAY,CAACjC,MAA3C,CAAf,CAHiC,CAIjC;AACH;;AACD,wBAAO,0CACFyB,cAAc,CAACS,SAAD,CADZ,EAGCC,YAAY,CAACnC,MAAb,GAAsB,CAAtB,gBACI;AAAI,MAAA,SAAS,EAAC,aAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAAG,oBAAC,SAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAAH,CADJ,eAEI;AAAI,MAAA,SAAS,EAAC,SAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAEQmC,YAAY,CAACR,GAAb,CAAiBzB,IAAI,IAAI;AACrB,YAAMmC,YAAY,GAAGnC,IAAI,CAACH,QAAL,IAAiBG,IAAI,CAACH,QAAL,CAAcC,MAAd,GAAuB,CAA7D;AACA,0BAAO;AAAI,QAAA,SAAS,EAAEqC,YAAY,GAAG,WAAH,GAAiB,EAA5C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBACH,oBAAC,IAAD;AAAM,QAAA,EAAE,EAAEnC,IAAI,CAAC6B,IAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAuB7B,IAAI,CAAC2B,IAA5B,CADG,EAGCQ,YAAY,gBAAG,uDACX;AAAI,QAAA,SAAS,EAAC,gBAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAEQnC,IAAI,CAACH,QAAL,CAAc4B,GAAd,CAAkB1B,OAAO,IAAI;AACzB,4BAAO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBACH,oBAAC,IAAD;AAAM,UAAA,GAAG,EAAEA,OAAO,CAAC2B,EAAnB;AAAuB,UAAA,EAAE,EAAE3B,OAAO,CAAC8B,IAAnC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WAA2C9B,OAAO,CAAC4B,IAAnD,CADG,CAAP;AAGH,OAJD,CAFR,CADW,CAAH,GAUN,IAbP,CAAP;AAgBH,KAlBD,CAFR,CAFJ,CADJ,GA0BY,IA7Bb,CAAP;AAgCH;;AACD,sBAAQ;AAAK,IAAA,SAAS,EAAC,MAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACJ;AAAK,IAAA,SAAS,EAAC,QAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACI,oBAAC,KAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADJ,CADI,eAIJ;AAAK,IAAA,SAAS,EAAC,eAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAEQ5C,aAAa,IAAIA,aAAa,CAACe,MAAd,GAAuB,CAAxC,GACMgC,UAAU,CAAC/C,aAAD,CADhB,GAEM,IAJd,CAKQ;AALR,GADJ,CAJI,CAAR;AAiBH;;AACD,MAAMqD,eAAe,GAAG,CAAC;AAAEC,EAAAA;AAAF,CAAD,KAAc;AAClC,QAAM;AAAEvD,IAAAA;AAAF,MAAeuD,IAArB;AACA,SAAO;AACHvD,IAAAA;AADG,GAAP;AAGH,CALD;;AAMA,eAAeT,OAAO,CAAC+D,eAAD,CAAP,CAAyBxD,OAAzB,CAAf","sourcesContent":["import React, { useState, useEffect, useMemo } from 'react'\nimport { LogoW } from '../../assets/images/index'\nimport { Link } from 'react-router-dom'\nimport { MENU } from '../../constants/Menu'\nimport { isModuleAccessible, canPerformAction } from '../../util/common'\nimport { connect } from 'react-redux'\nimport { USER_TYPE, isAdminUser } from '../../constants/User'\nimport { ReactComponent as MoreArrow } from '../../assets/images/more-arrow.svg';\nimport { ACTIONS } from '../../constants/subscription'\nconst _ = require('lodash')\n\nconst menuCount = 7\nfunction MenuBar(props) {\n\n    const { authUser } = props\n    const [filteredMenus, setFilteredMenus] = useState([])\n    const [loading, setLoading] = useState(true)\n    const tenantId = useMemo(() => {\n        return localStorage.getItem('tenantId')\n    }, [localStorage.getItem('tenantId')])\n\n    useEffect(() => {\n        let tempFilMenu = _.cloneDeep(MENU).filter(curMenu => {\n            if (curMenu && curMenu.visibilty) {\n                curMenu.shallRender = checkPermission(curMenu)\n\n                if (curMenu.children && curMenu.children.length) {\n                    curMenu.children = curMenu.children.filter(subMenu => {\n                        subMenu.shallRender = checkPermission(subMenu)\n                        if (subMenu.shallRender)\n                            return subMenu\n                    })\n                }\n            }\n            if (curMenu.shallRender)\n                return curMenu\n        })\n        setFilteredMenus(tempFilMenu)\n        if (loading) {\n            setLoading(false)\n        }\n    }, [tenantId])\n    const checkPermission = (menu) => {\n        let isSuperGenAdmin = [USER_TYPE.ADMIN.SUPER, USER_TYPE.ADMIN.GENERAL].indexOf(authUser.type) >= 0\n        let shallShow = false\n        if (menu) {\n            if (isSuperGenAdmin && (menu.hasOwnProperty(\"excludeGenAdmin\") && menu.excludeGenAdmin)) {\n                shallShow = false\n            } else if ([USER_TYPE.PHARMACY.ADMIN, USER_TYPE.HOME.ADMIN].indexOf(authUser.type) >= 0 && (menu.hasOwnProperty('excludePharHomeAdmin') && menu.excludePharHomeAdmin)) {\n                shallShow = false\n            }\n            else if (isSuperGenAdmin) {\n                shallShow = true\n            }\n            else if (menu.module) {\n                shallShow = isModuleAccessible(menu.module, false, menu.subModule)\n                if (menu.subModule && !isAdminUser(authUser.type)) {\n                    shallShow = canPerformAction({\n                        moduleId: menu.module,\n                        subModuleId: menu.subModule,\n                        checkSubAction: ACTIONS.LIST.CODE\n                    })\n                }\n            }\n            else if (menu.children && menu.children.length) {\n                let ans = menu.children.some(subMenu => {\n                    if ((subMenu.hasOwnProperty('showDefault') && subMenu.showDefault) && isSuperGenAdmin) {\n                        return true\n                    }\n                    if (checkPermission(subMenu)) {\n                        return true\n                    }\n                })\n                shallShow = ans\n            }\n        }\n        return shallShow\n    }\n\n    function RenderMenuList(menuArr) {\n        return menuArr.map(menu => {\n            if (menu.visibilty) {\n                if (menu.children && menu.children.length) {\n                    return < li key={menu.id} >\n                        <a>{menu.name} </a>\n                        <ul className=\"submenu\">\n                            <li>\n                                {\n                                    menu.children.map(subMenu => {\n                                        return (subMenu.hasOwnProperty('isPublic') && !subMenu.isPublic) ? null :\n                                            <Link key={subMenu.id} to={subMenu.path} >{subMenu.name}</Link>\n                                    })\n                                }\n                            </li>\n                        </ul>\n                    </li >\n                }\n                else {\n                    return <li key={menu.id}>\n                        <Link to={menu.path} >{menu.name}</Link>\n                    </li>\n                }\n            }\n        })\n    }\n\n    function RenderMenu(filteredMenu) {\n        // console.log(\"RenderMenu -> filteredMenu\", filteredMenu)\n        let showMenus = [...filteredMenu], showDropMenu = []\n        if (filteredMenu.length > menuCount) {\n            showMenus = filteredMenu.slice(0, menuCount)\n            // console.log(\"RenderMenu -> showMenus\", showMenus)\n            showDropMenu = filteredMenu.slice(menuCount, filteredMenu.length)\n            // console.log(\"RenderMenu -> showDropMenu\", showDropMenu)\n        }\n        return <>\n            {RenderMenuList(showMenus)}\n            {\n                showDropMenu.length > 0 ?\n                    <li className=\"more-h-menu\">\n                        <a><MoreArrow /></a>\n                        <ul className=\"submenu\">\n                            {\n                                showDropMenu.map(menu => {\n                                    const isChildExist = menu.children && menu.children.length > 0\n                                    return <li className={isChildExist ? \"has-child\" : \"\"}>\n                                        <Link to={menu.path} >{menu.name}</Link>\n                                        {\n                                            isChildExist ? <>\n                                                <ul className=\"sub-child-menu\">\n                                                    {\n                                                        menu.children.map(subMenu => {\n                                                            return <li>\n                                                                <Link key={subMenu.id} to={subMenu.path} >{subMenu.name}</Link>\n                                                            </li>\n                                                        })\n                                                    }\n                                                </ul>\n                                            </> : null\n                                        }\n                                    </li>\n                                })\n                            }\n                        </ul>\n                    </li> : null\n            }\n        </>\n    }\n    return (<div className=\"menu\">\n        <div className=\"h_logo\">\n            <LogoW />\n        </div>\n        <div className=\"nav_link_wrap\">\n            <ul>\n                {\n                    filteredMenus && filteredMenus.length > 0\n                        ? RenderMenu(filteredMenus)\n                        : null\n                    // <Spin spinning={true} />\n                }\n            </ul>\n        </div>\n    </div>\n\n    )\n}\nconst mapStateToProps = ({ auth }) => {\n    const { authUser } = auth\n    return {\n        authUser\n    }\n}\nexport default connect(mapStateToProps)(MenuBar);\n"]},"metadata":{},"sourceType":"module"}