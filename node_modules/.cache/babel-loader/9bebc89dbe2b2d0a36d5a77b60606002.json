{"ast":null,"code":"var _jsxFileName = \"/home/gauravpendherkar/DemoWriti/src/containers/Support/index.js\";\nimport React, { useState, useEffect } from 'react';\nimport { Toast, Button, LightBox } from '../../../src/components/common/index';\nimport { View } from \"../../../src/assets/images/pmr/index\";\nimport { connect } from 'react-redux';\nimport { Info } from '../../../src/assets/images/popup';\nimport Dialog from 'rc-dialog';\nimport Table from '../../../src/components/common/Table/index';\nimport ConnectWritiForm from './components/ConnectWritiForm';\nimport { Cancel } from '../../../src/assets/images/resident-detail/index';\nimport RequestFeatureForm from './components/RequestFeatureForm';\nimport BugsForm from './components/BugsForm';\nimport { supportUpsert, supportPaginate, supportDelete, supportUpdate } from '../../../src/services/api/routes/supportFeedback';\nimport { masterPaginate } from '../../../src/services/api/routes/master';\nimport { SUPPORT_TYPE, URGENCY } from '../../constants/supportFeedback';\nimport { DEVICE_TYPE } from '../../constants/common';\nimport { USER_TYPE } from '../../constants/User';\nimport axios from '../../../src/services/api/config';\nimport Uploader, { FILE_CATEGORY, FILE_TYPES } from '../../../src/components/common/Upload/Uploader';\nimport { fileUpload } from '../../../src/services/api/routes/common';\nimport Header from './components/Header';\nimport { createForm } from 'rc-form';\nimport { canPerformAction } from '../../../src/util/common';\nimport { MODULE, ACTIONS } from '../../../src/constants/subscription';\nimport ConfirmPopup from '../../../src/components/common/ConfirmPopup';\nimport moment from 'moment';\nimport { find } from 'lodash';\n\nconst _ = require('lodash');\n\nconst Support = props => {\n  const {\n    form,\n    authUser\n  } = props;\n  const [radioValue, setRadioValue] = useState(SUPPORT_TYPE.CONNECT_WITH_WRITI);\n  const [visibleImage, setVisibleImage] = useState(false);\n  const [detail, setDetail] = useState([]);\n  const isAdmin = authUser && (authUser.type === USER_TYPE.ADMIN.SUPER || authUser.type === USER_TYPE.ADMIN.GENERAL);\n  const initialFilter = {\n    page: 1,\n    limit: 10,\n    fields: [],\n    sortBy: {\n      createdAt: 'DESC'\n    },\n    find: {},\n    populate: [{\n      addedBy: ['firstName', 'lastName', 'mergeLFName']\n    }, {\n      category: ['name']\n    }]\n  };\n  const [filter, setFilter] = useState(() => {\n    if (!isAdmin) {\n      _.assignIn(initialFilter.find, {\n        addedBy: authUser._id\n      });\n    }\n\n    return initialFilter;\n  });\n  const {\n    resetFields\n  } = form;\n  const [visible, setVisible] = useState(false);\n  const [attechmentVisible, setattechmentVisible] = useState(false);\n  const [attechment, setAttechment] = useState([]);\n  const [fileData, setFileData] = useState([]);\n  const [supportData, setSupportData] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const [btnLoading, setBtnLoading] = useState(false);\n  const [openConnectModal, setOpenConnectModal] = useState(true);\n  const [openRequestModal, setOpenRequestModal] = useState(false);\n  const [openBugModal, setOpenBugModal] = useState(false);\n  const [deleteModal, setDeleteModal] = useState(false);\n  const [getMasterName, setMasterName] = useState();\n  const [getRecord, setRecord] = useState('');\n  const [supportType, setSupportType] = useState(SUPPORT_TYPE.CONNECT_WITH_WRITI);\n  const [data, setData] = useState([]);\n  const [total, setTotal] = useState('');\n  const checkAddAction = canPerformAction({\n    moduleId: MODULE.SUPPORT,\n    actiontoCheck: ACTIONS.ADD.CODE\n  });\n  useEffect(() => {\n    fetchMaster();\n  }, []);\n  useEffect(() => {\n    fetch();\n  }, [filter, radioValue]);\n  useEffect(() => {\n    if (attechment) {\n      handleUpdate();\n    }\n  }, [attechment]);\n\n  const handleUpdate = () => {\n    if (supportData === null || supportData === void 0 ? void 0 : supportData._id) {\n      let {\n        url,\n        method,\n        baseURL\n      } = supportUpdate;\n      url = `${url}/${supportData._id}`;\n      let imgData;\n\n      _.map(attechment, img => {\n        imgData = img === null || img === void 0 ? void 0 : img.path;\n      });\n\n      let obj = {\n        attachments: [{\n          path: imgData\n        }]\n      };\n      axios({\n        url,\n        method,\n        baseURL,\n        data: obj\n      }).then(response => {\n        if ((response === null || response === void 0 ? void 0 : response.data.code) == 'OK') {\n          Toast.success(response.data.message);\n          fetch();\n        }\n      }).catch(error => {\n        console.log(error);\n      });\n    }\n  };\n\n  const handleSupportModalOpen = () => {\n    setVisible(true);\n  };\n\n  const modifiedList = list => {\n    let modifiedList = list.map(current => {\n      return current;\n    });\n    return modifiedList;\n  };\n\n  const fetch = () => {\n    setLoading(true);\n    let {\n      method,\n      url,\n      baseURL\n    } = supportPaginate;\n    axios({\n      method,\n      url,\n      baseURL,\n      data: {\n        query: { ...filter,\n          find: { ...filter.find,\n            type: radioValue\n          }\n        }\n      }\n    }).then(response => {\n      if (response && response.data.code == 'OK') {\n        let updatedList = modifiedList(response.data.data.data);\n        setData(updatedList);\n        setTotal(response.data.data.count);\n        setLoading(false);\n      }\n    }).catch(error => {\n      console.log(error);\n      setLoading(false);\n    });\n  };\n\n  const handleTableChange = (pagination, tfilter, sorter) => {\n    if (!pagination) return;\n    let tempFilter = filter;\n    tempFilter = { ...tempFilter,\n      page: pagination.current,\n      limit: pagination.pageSize\n    };\n\n    if (tfilter && Object.keys(tfilter).length) {\n      if (tfilter.isActive && tfilter.isActive.length) {\n        tempFilter.find.isActive = tfilter.isActive;\n      } else if (tempFilter.find.isActive) {\n        delete tempFilter.find['isActive'];\n      }\n\n      tempFilter.page = 1;\n    } else {// tempFilter.filter = {\n      //     type: tempFilter.filter.type\n      // }\n    }\n\n    setFilter(tempFilter);\n  };\n\n  const onShowSizeChange = size => {\n    if (size) {\n      setFilter(prevFilter => ({ ...prevFilter,\n        limit: size,\n        page: 1\n      }));\n    }\n  };\n\n  const fetchMaster = () => {\n    let {\n      method,\n      url,\n      baseURL\n    } = masterPaginate;\n    axios({\n      url,\n      method,\n      baseURL\n    }).then(response => {\n      if (response.data.code == 'OK') {\n        setMasterName(response.data.data.data);\n      }\n    }).catch(error => {\n      Toast.error(error);\n    });\n  };\n\n  const handleAttechmentVisible = record => {\n    if ((record === null || record === void 0 ? void 0 : record._id) && (record === null || record === void 0 ? void 0 : record.attachments.length)) {\n      setFileData(record === null || record === void 0 ? void 0 : record.attachments);\n    } else {\n      setFileData(null);\n    }\n\n    setattechmentVisible(true);\n    setSupportData(record);\n  };\n\n  const handleOpenConnectModal = () => {\n    setOpenRequestModal(false);\n    setOpenBugModal(false);\n    setOpenConnectModal(true);\n  };\n\n  const handleOpenRequestModal = () => {\n    setOpenConnectModal(false);\n    setOpenBugModal(false);\n    setOpenRequestModal(true);\n  };\n\n  const handleOpenBugModal = () => {\n    setOpenConnectModal(false);\n    setOpenRequestModal(false);\n    setOpenBugModal(true);\n  };\n\n  const handleConnectSubmit = value => {\n    setBtnLoading(true);\n    let {\n      method,\n      url,\n      baseURL\n    } = supportUpsert;\n    axios({\n      method,\n      url,\n      data: value,\n      baseURL\n    }).then(data => {\n      if (data && data.data.code == 'OK') {\n        setBtnLoading(false);\n        resetFields();\n        setVisible(false);\n        Toast.success(data.data.message);\n        fetch();\n      }\n    }).catch(error => {\n      setBtnLoading(false);\n      Toast.error(error);\n    });\n  };\n\n  const handleRequestSubmit = value => {\n    setBtnLoading(true);\n    let {\n      method,\n      url,\n      baseURL\n    } = supportUpsert;\n    axios({\n      method,\n      url,\n      data: value,\n      baseURL\n    }).then(data => {\n      if (data && data.data.code == 'OK') {\n        setBtnLoading(false);\n        resetFields();\n        setVisible(false);\n        Toast.success(data.data.message);\n        fetch();\n      }\n    }).catch(error => {\n      setBtnLoading(false);\n      Toast.error(error);\n    });\n  };\n\n  const handleBugSubmit = value => {\n    setBtnLoading(true);\n    let {\n      method,\n      url,\n      baseURL\n    } = supportUpsert;\n    axios({\n      method,\n      url,\n      data: value,\n      baseURL\n    }).then(data => {\n      if (data && data.data.code == 'OK') {\n        setBtnLoading(false);\n        resetFields();\n        setVisible(false);\n        Toast.success(data.data.message);\n        fetch();\n      }\n    }).catch(error => {\n      setBtnLoading(false);\n      Toast.error(error);\n    });\n  };\n\n  const handleSubmit = value => {\n    setSupportType(value);\n\n    if (value === SUPPORT_TYPE['CONNECT_WITH_WRITI']) {\n      return handleOpenConnectModal();\n    } else if (value === SUPPORT_TYPE['REQUEST_A_FEATURE']) {\n      return handleOpenRequestModal();\n    } else if (value === SUPPORT_TYPE['SUBMIT_A_BUG']) {\n      return handleOpenBugModal();\n    }\n  }; // const handleUpdate = () => {\n  //   const { url, method, baseURL } = supportUpdate;\n  //   url = `${url}/${supportData._id}`;\n  //   let obj = {\n  //     attachments: data.path,\n  //   };\n  //   axios({ url, method, baseURL, data: obj })\n  //     .then((response) => {\n  //       console.log('response', response);\n  //     })\n  //     .catch((error) => {\n  //       console.log(error);\n  //     });\n  // };\n\n\n  let deleteParams = {\n    moduleId: MODULE.SUPPORT,\n    actiontoCheck: ACTIONS.DELETE.CODE\n  };\n  let tableListParams = {\n    moduleId: MODULE.SUPPORT,\n    actiontoCheck: ACTIONS.LIST.CODE\n  };\n\n  const handleRadioValue = event => {\n    setLoading(true);\n    setRadioValue(parseInt(event.target.value));\n  };\n\n  const getColumns = () => [{\n    title: 'Sr.No',\n    keyword: 'index',\n    dataIndex: 'index',\n    render: (text, record, index) => (filter.page - 1) * filter.limit + (index + 1)\n  }, {\n    title: radioValue === SUPPORT_TYPE.REQUEST_A_FEATURE ? 'Title' : '',\n    dataIndex: radioValue === SUPPORT_TYPE.REQUEST_A_FEATURE ? 'title' : '',\n    render: (text, record) => /*#__PURE__*/React.createElement(React.Fragment, null, text ? radioValue === SUPPORT_TYPE.REQUEST_A_FEATURE ? text : '' : '')\n  }, {\n    title: radioValue === SUPPORT_TYPE.REQUEST_A_FEATURE ? 'Category' : '',\n    dataIndex: radioValue === SUPPORT_TYPE.REQUEST_A_FEATURE ? 'category' : '',\n    render: (text, record) => /*#__PURE__*/React.createElement(React.Fragment, null, text ? text.name : '')\n  }, {\n    title: 'Query',\n    dataIndex: 'query',\n    render: (text, record) => /*#__PURE__*/React.createElement(React.Fragment, null, text ? text : ' - ')\n  }, {\n    title: radioValue == SUPPORT_TYPE.SUBMIT_A_BUG ? 'Platform' : '',\n    dataIndex: radioValue == SUPPORT_TYPE.SUBMIT_A_BUG ? 'platform' : '',\n    render: (text, record) => /*#__PURE__*/React.createElement(React.Fragment, null, text ? Object.keys(DEVICE_TYPE).map(device => {\n      return DEVICE_TYPE[device] === text ? device : '';\n    }) : '')\n  }, {\n    title: radioValue == SUPPORT_TYPE.CONNECT_WITH_WRITI || radioValue == SUPPORT_TYPE.SUBMIT_A_BUG ? 'Urgency' : '',\n    dataIndex: radioValue == SUPPORT_TYPE.CONNECT_WITH_WRITI || radioValue == SUPPORT_TYPE.SUBMIT_A_BUG ? 'urgency' : '',\n    render: text => text ? Object.keys(URGENCY).map(urgency => {\n      return /*#__PURE__*/React.createElement(\"span\", {\n        style: {\n          color: text == URGENCY.HIGH ? 'Red' : 'Black'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 407,\n          columnNumber: 15\n        }\n      }, URGENCY[urgency] === text ? urgency : '');\n    }) : ''\n  }, {\n    title: radioValue == SUPPORT_TYPE.CONNECT_WITH_WRITI || radioValue == SUPPORT_TYPE.REQUEST_A_FEATURE ? 'RequestBy' : '',\n    dataIndex: radioValue == SUPPORT_TYPE.CONNECT_WITH_WRITI || radioValue == SUPPORT_TYPE.REQUEST_A_FEATURE ? 'addedBy' : '',\n    render: text => /*#__PURE__*/React.createElement(\"span\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 426,\n        columnNumber: 9\n      }\n    }, text ? `${text.lastName},${text.firstName}` : '')\n  }, {\n    title: radioValue == SUPPORT_TYPE.CONNECT_WITH_WRITI || radioValue == SUPPORT_TYPE.REQUEST_A_FEATURE ? 'Date' : '',\n    dataIndex: radioValue == SUPPORT_TYPE.CONNECT_WITH_WRITI || radioValue == SUPPORT_TYPE.REQUEST_A_FEATURE ? 'createdAt' : '',\n    render: text => /*#__PURE__*/React.createElement(\"span\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 441,\n        columnNumber: 9\n      }\n    }, text ? moment(text).format('MM/DD/YYYY, HH:mm') : '')\n  }, {\n    title: radioValue == SUPPORT_TYPE.REQUEST_A_FEATURE ? 'View Attechment' : '',\n    dataIndex: radioValue == SUPPORT_TYPE.REQUEST_A_FEATURE ? 'attachments' : '',\n    render: (record, text) => radioValue == SUPPORT_TYPE.REQUEST_A_FEATURE ? /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"span\", {\n      onClick: () => {\n        handleAttechmentVisible(text);\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 452,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(Info, {\n      style: {\n        marginTop: '-7px',\n        marginRight: '45px',\n        cursor: 'pointer',\n        width: '20px',\n        height: '20px'\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 457,\n        columnNumber: 15\n      }\n    }))) : null\n  }, {\n    title: 'Action',\n    showRefresh: true,\n    render: (text, record) => /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"actions\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 477,\n        columnNumber: 11\n      }\n    }, canPerformAction(deleteParams) ? /*#__PURE__*/React.createElement(\"a\", {\n      onClick: () => {\n        setDeleteModal(true);\n        setRecord(record);\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 488,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(Cancel, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 494,\n        columnNumber: 17\n      }\n    }), /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 495,\n        columnNumber: 17\n      }\n    }, \"Delete\")) : null, record && record.attachments && _.size(record.attachments) > 0 ? /*#__PURE__*/React.createElement(\"span\", {\n      onClick: () => {\n        handleViewImages(true, record);\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 499,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(View, {\n      style: {\n        cursor: 'pointer'\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 500,\n        columnNumber: 17\n      }\n    })) : null))\n  }];\n\n  const handleDelete = id => {\n    let {\n      method,\n      url,\n      baseURL\n    } = supportDelete;\n    url = `${url}/${id}`;\n    axios({\n      method,\n      url,\n      baseURL\n    }).then(response => {\n      setDeleteModal(false);\n      fetch();\n    }).catch(error => {\n      Toast.error(error);\n    });\n  };\n\n  const handleViewImages = (action, record) => {\n    setVisibleImage(action);\n\n    if (record === null || record === void 0 ? void 0 : record.attachments) {\n      _.map(record === null || record === void 0 ? void 0 : record.attachments, img => {\n        img.caption = `${record.title}`;\n        img.src = img === null || img === void 0 ? void 0 : img.path;\n      });\n\n      setDetail(record === null || record === void 0 ? void 0 : record.attachments);\n    }\n  };\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"pmr_wrap\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 535,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 536,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Header, {\n    total: total,\n    onRadioValue: radioValue,\n    onVisible: handleSupportModalOpen,\n    onHandleRadioValue: handleRadioValue,\n    onCheckAddAction: checkAddAction,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 537,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(Table, {\n    columns: canPerformAction(tableListParams) ? getColumns() : null,\n    datasource: data,\n    loading: loading,\n    onChange: handleTableChange,\n    pagination: {\n      current: filter.page,\n      pageSize: filter.limit,\n      total: total,\n      showSizeChanger: true,\n      onShowSizeChange: onShowSizeChange\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 544,\n      columnNumber: 11\n    }\n  }))), visible && /*#__PURE__*/React.createElement(Dialog, {\n    visible: visible,\n    maskClosable: false,\n    onClose: () => {\n      setVisible(false);\n    },\n    onCancel: () => {\n      setVisible(false);\n    },\n    style: {\n      width: '50%'\n    },\n    className: \"search_popup_wrap\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 561,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"popup-search-con\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 573,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    className: \"name_head text-left\",\n    style: {\n      color: '#000000'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 574,\n      columnNumber: 13\n    }\n  }, \"Support\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"rx-btns drug-bts\",\n    style: {\n      marginBottom: '3%'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 578,\n      columnNumber: 13\n    }\n  }, Object.keys(SUPPORT_TYPE).map((name, index) => {\n    return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"a\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 582,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(Button, {\n      className: supportType === SUPPORT_TYPE[name] ? 'r-o-btn' : null,\n      onClick: () => {\n        handleSubmit(SUPPORT_TYPE[name]);\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 583,\n        columnNumber: 23\n      }\n    }, name.replace(/_/g, ' '))));\n  })), openConnectModal && /*#__PURE__*/React.createElement(ConnectWritiForm // editRecord={getRecord ? getRecord : null}\n  , {\n    supportType: supportType,\n    onSubmit: handleConnectSubmit,\n    handleCancel: () => {\n      resetFields();\n      setVisible(false);\n    },\n    form: form,\n    loading: btnLoading,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 600,\n      columnNumber: 15\n    }\n  }), openRequestModal && /*#__PURE__*/React.createElement(RequestFeatureForm, {\n    masterData: getMasterName,\n    supportType: supportType,\n    handleCancel: () => {\n      resetFields();\n      setVisible(false);\n    },\n    handleSubmit: handleRequestSubmit,\n    form: form,\n    loading: btnLoading,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 613,\n      columnNumber: 15\n    }\n  }), openBugModal && /*#__PURE__*/React.createElement(BugsForm, {\n    authUser: authUser,\n    supportType: supportType,\n    handleCancel: () => {\n      resetFields();\n      setVisible(false);\n    },\n    handleSubmit: handleBugSubmit,\n    form: form,\n    loading: btnLoading,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 626,\n      columnNumber: 15\n    }\n  })), /*#__PURE__*/React.createElement(\"button\", {\n    className: \"close-btn\",\n    onClick: () => {\n      setVisible(false);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 640,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    alt: \"#\",\n    src: require('../../../src/assets/images/popup/close.svg'),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 646,\n      columnNumber: 13\n    }\n  }))), deleteModal && /*#__PURE__*/React.createElement(ConfirmPopup, {\n    value: getRecord,\n    visible: deleteModal,\n    title: `Delete Note -  ${getRecord.query}`,\n    description: \"Are you want to delete this record\",\n    onOk: () => {\n      handleDelete(getRecord && getRecord._id);\n    },\n    okText: \"Yes\",\n    cancelText: \"Cancel\",\n    onClose: () => {\n      setDeleteModal(false);\n    },\n    onCancel: () => {\n      setDeleteModal(false);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 655,\n      columnNumber: 9\n    }\n  }), attechmentVisible && /*#__PURE__*/React.createElement(Uploader, {\n    visible: attechmentVisible,\n    onRequestClose: () => setattechmentVisible(false),\n    multiple: true,\n    title: \"View Attechment\" // defaultList={fileData?.map((data) => {\n    //   return data?.path;\n    // })}\n    ,\n    uploadUrl: { ...fileUpload\n    },\n    allowedTypes: FILE_TYPES.IMAGE,\n    extraData: {\n      isUploadToS3: true,\n      category: [FILE_CATEGORY.IMAGE].join(',')\n    },\n    maxSizeInMB: 1,\n    onError: err => {\n      Toast.error(err);\n    },\n    onSuccess: uploaded => {\n      if ((uploaded === null || uploaded === void 0 ? void 0 : uploaded.code) === 'OK') {\n        setAttechment(uploaded.data);\n        setattechmentVisible(false);\n      }\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 675,\n      columnNumber: 9\n    }\n  }), visibleImage && /*#__PURE__*/React.createElement(LightBox, {\n    visible: visibleImage,\n    images: detail,\n    onCloseRequest: () => handleViewImages(false),\n    curImg: 0,\n    imageTitle: {\n      caption: true\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 703,\n      columnNumber: 9\n    }\n  }));\n};\n\nconst mapStateToProps = ({\n  auth\n}) => {\n  const {\n    authUser\n  } = auth;\n  return {\n    authUser\n  };\n};\n\nexport default connect(mapStateToProps)(createForm()(Support));","map":{"version":3,"sources":["/home/gauravpendherkar/DemoWriti/src/containers/Support/index.js"],"names":["React","useState","useEffect","Toast","Button","LightBox","View","connect","Info","Dialog","Table","ConnectWritiForm","Cancel","RequestFeatureForm","BugsForm","supportUpsert","supportPaginate","supportDelete","supportUpdate","masterPaginate","SUPPORT_TYPE","URGENCY","DEVICE_TYPE","USER_TYPE","axios","Uploader","FILE_CATEGORY","FILE_TYPES","fileUpload","Header","createForm","canPerformAction","MODULE","ACTIONS","ConfirmPopup","moment","find","_","require","Support","props","form","authUser","radioValue","setRadioValue","CONNECT_WITH_WRITI","visibleImage","setVisibleImage","detail","setDetail","isAdmin","type","ADMIN","SUPER","GENERAL","initialFilter","page","limit","fields","sortBy","createdAt","populate","addedBy","category","filter","setFilter","assignIn","_id","resetFields","visible","setVisible","attechmentVisible","setattechmentVisible","attechment","setAttechment","fileData","setFileData","supportData","setSupportData","loading","setLoading","btnLoading","setBtnLoading","openConnectModal","setOpenConnectModal","openRequestModal","setOpenRequestModal","openBugModal","setOpenBugModal","deleteModal","setDeleteModal","getMasterName","setMasterName","getRecord","setRecord","supportType","setSupportType","data","setData","total","setTotal","checkAddAction","moduleId","SUPPORT","actiontoCheck","ADD","CODE","fetchMaster","fetch","handleUpdate","url","method","baseURL","imgData","map","img","path","obj","attachments","then","response","code","success","message","catch","error","console","log","handleSupportModalOpen","modifiedList","list","current","query","updatedList","count","handleTableChange","pagination","tfilter","sorter","tempFilter","pageSize","Object","keys","length","isActive","onShowSizeChange","size","prevFilter","handleAttechmentVisible","record","handleOpenConnectModal","handleOpenRequestModal","handleOpenBugModal","handleConnectSubmit","value","handleRequestSubmit","handleBugSubmit","handleSubmit","deleteParams","DELETE","tableListParams","LIST","handleRadioValue","event","parseInt","target","getColumns","title","keyword","dataIndex","render","text","index","REQUEST_A_FEATURE","name","SUBMIT_A_BUG","device","urgency","color","HIGH","lastName","firstName","format","marginTop","marginRight","cursor","width","height","showRefresh","handleViewImages","handleDelete","id","action","caption","src","showSizeChanger","marginBottom","replace","IMAGE","isUploadToS3","join","err","uploaded","mapStateToProps","auth"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,QAAhB,EAA0BC,SAA1B,QAA2C,OAA3C;AACA,SAASC,KAAT,EAAgBC,MAAhB,EAAwBC,QAAxB,QAAwC,sCAAxC;AACA,SAASC,IAAT,QAAqB,sCAArB;AACA,SAASC,OAAT,QAAwB,aAAxB;AACA,SAASC,IAAT,QAAqB,kCAArB;AACA,OAAOC,MAAP,MAAmB,WAAnB;AACA,OAAOC,KAAP,MAAkB,4CAAlB;AACA,OAAOC,gBAAP,MAA6B,+BAA7B;AACA,SAASC,MAAT,QAAuB,kDAAvB;AACA,OAAOC,kBAAP,MAA+B,iCAA/B;AACA,OAAOC,QAAP,MAAqB,uBAArB;AACA,SACEC,aADF,EAEEC,eAFF,EAGEC,aAHF,EAIEC,aAJF,QAKO,kDALP;AAMA,SAASC,cAAT,QAA+B,yCAA/B;AACA,SAASC,YAAT,EAAuBC,OAAvB,QAAsC,iCAAtC;AACA,SAASC,WAAT,QAA4B,wBAA5B;AACA,SAASC,SAAT,QAA0B,sBAA1B;AACA,OAAOC,KAAP,MAAkB,kCAAlB;AACA,OAAOC,QAAP,IACEC,aADF,EAEEC,UAFF,QAGO,gDAHP;AAIA,SAASC,UAAT,QAA2B,yCAA3B;AACA,OAAOC,MAAP,MAAmB,qBAAnB;AACA,SAASC,UAAT,QAA2B,SAA3B;AACA,SAASC,gBAAT,QAAiC,0BAAjC;AACA,SAASC,MAAT,EAAiBC,OAAjB,QAAgC,qCAAhC;AACA,OAAOC,YAAP,MAAyB,6CAAzB;AACA,OAAOC,MAAP,MAAmB,QAAnB;AACA,SAASC,IAAT,QAAqB,QAArB;;AACA,MAAMC,CAAC,GAAGC,OAAO,CAAC,QAAD,CAAjB;;AAEA,MAAMC,OAAO,GAAIC,KAAD,IAAW;AACzB,QAAM;AAAEC,IAAAA,IAAF;AAAQC,IAAAA;AAAR,MAAqBF,KAA3B;AAEA,QAAM,CAACG,UAAD,EAAaC,aAAb,IAA8B3C,QAAQ,CAACmB,YAAY,CAACyB,kBAAd,CAA5C;AACA,QAAM,CAACC,YAAD,EAAeC,eAAf,IAAkC9C,QAAQ,CAAC,KAAD,CAAhD;AACA,QAAM,CAAC+C,MAAD,EAASC,SAAT,IAAsBhD,QAAQ,CAAC,EAAD,CAApC;AAEA,QAAMiD,OAAO,GACXR,QAAQ,KACPA,QAAQ,CAACS,IAAT,KAAkB5B,SAAS,CAAC6B,KAAV,CAAgBC,KAAlC,IACCX,QAAQ,CAACS,IAAT,KAAkB5B,SAAS,CAAC6B,KAAV,CAAgBE,OAF5B,CADV;AAKA,QAAMC,aAAa,GAAG;AACpBC,IAAAA,IAAI,EAAE,CADc;AAEpBC,IAAAA,KAAK,EAAE,EAFa;AAGpBC,IAAAA,MAAM,EAAE,EAHY;AAIpBC,IAAAA,MAAM,EAAE;AAAEC,MAAAA,SAAS,EAAE;AAAb,KAJY;AAKpBxB,IAAAA,IAAI,EAAE,EALc;AAMpByB,IAAAA,QAAQ,EAAE,CACR;AACEC,MAAAA,OAAO,EAAE,CAAC,WAAD,EAAc,UAAd,EAA0B,aAA1B;AADX,KADQ,EAIR;AACEC,MAAAA,QAAQ,EAAE,CAAC,MAAD;AADZ,KAJQ;AANU,GAAtB;AAgBA,QAAM,CAACC,MAAD,EAASC,SAAT,IAAsBhE,QAAQ,CAAC,MAAM;AACzC,QAAI,CAACiD,OAAL,EAAc;AACZb,MAAAA,CAAC,CAAC6B,QAAF,CAAWX,aAAa,CAACnB,IAAzB,EAA+B;AAAE0B,QAAAA,OAAO,EAAEpB,QAAQ,CAACyB;AAApB,OAA/B;AACD;;AACD,WAAOZ,aAAP;AACD,GALmC,CAApC;AAOA,QAAM;AAAEa,IAAAA;AAAF,MAAkB3B,IAAxB;AACA,QAAM,CAAC4B,OAAD,EAAUC,UAAV,IAAwBrE,QAAQ,CAAC,KAAD,CAAtC;AACA,QAAM,CAACsE,iBAAD,EAAoBC,oBAApB,IAA4CvE,QAAQ,CAAC,KAAD,CAA1D;AACA,QAAM,CAACwE,UAAD,EAAaC,aAAb,IAA8BzE,QAAQ,CAAC,EAAD,CAA5C;AACA,QAAM,CAAC0E,QAAD,EAAWC,WAAX,IAA0B3E,QAAQ,CAAC,EAAD,CAAxC;AACA,QAAM,CAAC4E,WAAD,EAAcC,cAAd,IAAgC7E,QAAQ,CAAC,EAAD,CAA9C;AAEA,QAAM,CAAC8E,OAAD,EAAUC,UAAV,IAAwB/E,QAAQ,CAAC,KAAD,CAAtC;AACA,QAAM,CAACgF,UAAD,EAAaC,aAAb,IAA8BjF,QAAQ,CAAC,KAAD,CAA5C;AACA,QAAM,CAACkF,gBAAD,EAAmBC,mBAAnB,IAA0CnF,QAAQ,CAAC,IAAD,CAAxD;AACA,QAAM,CAACoF,gBAAD,EAAmBC,mBAAnB,IAA0CrF,QAAQ,CAAC,KAAD,CAAxD;AACA,QAAM,CAACsF,YAAD,EAAeC,eAAf,IAAkCvF,QAAQ,CAAC,KAAD,CAAhD;AACA,QAAM,CAACwF,WAAD,EAAcC,cAAd,IAAgCzF,QAAQ,CAAC,KAAD,CAA9C;AACA,QAAM,CAAC0F,aAAD,EAAgBC,aAAhB,IAAiC3F,QAAQ,EAA/C;AACA,QAAM,CAAC4F,SAAD,EAAYC,SAAZ,IAAyB7F,QAAQ,CAAC,EAAD,CAAvC;AACA,QAAM,CAAC8F,WAAD,EAAcC,cAAd,IAAgC/F,QAAQ,CAC5CmB,YAAY,CAACyB,kBAD+B,CAA9C;AAIA,QAAM,CAACoD,IAAD,EAAOC,OAAP,IAAkBjG,QAAQ,CAAC,EAAD,CAAhC;AACA,QAAM,CAACkG,KAAD,EAAQC,QAAR,IAAoBnG,QAAQ,CAAC,EAAD,CAAlC;AAGA,QAAMoG,cAAc,GAAGtE,gBAAgB,CAAC;AACtCuE,IAAAA,QAAQ,EAAEtE,MAAM,CAACuE,OADqB;AAEtCC,IAAAA,aAAa,EAAEvE,OAAO,CAACwE,GAAR,CAAYC;AAFW,GAAD,CAAvC;AAKAxG,EAAAA,SAAS,CAAC,MAAM;AACdyG,IAAAA,WAAW;AACZ,GAFQ,EAEN,EAFM,CAAT;AAIAzG,EAAAA,SAAS,CAAC,MAAM;AACd0G,IAAAA,KAAK;AACN,GAFQ,EAEN,CAAC5C,MAAD,EAASrB,UAAT,CAFM,CAAT;AAIAzC,EAAAA,SAAS,CAAC,MAAM;AACd,QAAIuE,UAAJ,EAAgB;AACdoC,MAAAA,YAAY;AACb;AACF,GAJQ,EAIN,CAACpC,UAAD,CAJM,CAAT;;AAMA,QAAMoC,YAAY,GAAG,MAAM;AACzB,QAAIhC,WAAJ,aAAIA,WAAJ,uBAAIA,WAAW,CAAEV,GAAjB,EAAsB;AACpB,UAAI;AAAE2C,QAAAA,GAAF;AAAOC,QAAAA,MAAP;AAAeC,QAAAA;AAAf,UAA2B9F,aAA/B;AACA4F,MAAAA,GAAG,GAAI,GAAEA,GAAI,IAAGjC,WAAW,CAACV,GAAI,EAAhC;AACA,UAAI8C,OAAJ;;AACA5E,MAAAA,CAAC,CAAC6E,GAAF,CAAMzC,UAAN,EAAmB0C,GAAD,IAAS;AACzBF,QAAAA,OAAO,GAAGE,GAAH,aAAGA,GAAH,uBAAGA,GAAG,CAAEC,IAAf;AACD,OAFD;;AAIA,UAAIC,GAAG,GAAG;AACRC,QAAAA,WAAW,EAAE,CAAC;AAAEF,UAAAA,IAAI,EAAEH;AAAR,SAAD;AADL,OAAV;AAGAzF,MAAAA,KAAK,CAAC;AAAEsF,QAAAA,GAAF;AAAOC,QAAAA,MAAP;AAAeC,QAAAA,OAAf;AAAwBf,QAAAA,IAAI,EAAEoB;AAA9B,OAAD,CAAL,CACGE,IADH,CACSC,QAAD,IAAc;AAClB,YAAI,CAAAA,QAAQ,SAAR,IAAAA,QAAQ,WAAR,YAAAA,QAAQ,CAAEvB,IAAV,CAAewB,IAAf,KAAuB,IAA3B,EAAiC;AAC/BtH,UAAAA,KAAK,CAACuH,OAAN,CAAcF,QAAQ,CAACvB,IAAT,CAAc0B,OAA5B;AACAf,UAAAA,KAAK;AACN;AACF,OANH,EAOGgB,KAPH,CAOUC,KAAD,IAAW;AAChBC,QAAAA,OAAO,CAACC,GAAR,CAAYF,KAAZ;AACD,OATH;AAUD;AACF,GAvBD;;AAwBA,QAAMG,sBAAsB,GAAG,MAAM;AACnC1D,IAAAA,UAAU,CAAC,IAAD,CAAV;AACD,GAFD;;AAIA,QAAM2D,YAAY,GAAIC,IAAD,IAAU;AAC7B,QAAID,YAAY,GAAGC,IAAI,CAAChB,GAAL,CAAUiB,OAAD,IAAa;AACvC,aAAOA,OAAP;AACD,KAFkB,CAAnB;AAGA,WAAOF,YAAP;AACD,GALD;;AAOA,QAAMrB,KAAK,GAAG,MAAM;AAClB5B,IAAAA,UAAU,CAAC,IAAD,CAAV;AACA,QAAI;AAAE+B,MAAAA,MAAF;AAAUD,MAAAA,GAAV;AAAeE,MAAAA;AAAf,QAA2BhG,eAA/B;AACAQ,IAAAA,KAAK,CAAC;AACJuF,MAAAA,MADI;AAEJD,MAAAA,GAFI;AAGJE,MAAAA,OAHI;AAIJf,MAAAA,IAAI,EAAE;AACJmC,QAAAA,KAAK,EAAE,EACL,GAAGpE,MADE;AAEL5B,UAAAA,IAAI,EAAE,EACJ,GAAG4B,MAAM,CAAC5B,IADN;AAEJe,YAAAA,IAAI,EAAER;AAFF;AAFD;AADH;AAJF,KAAD,CAAL,CAcG4E,IAdH,CAcSC,QAAD,IAAc;AAClB,UAAIA,QAAQ,IAAIA,QAAQ,CAACvB,IAAT,CAAcwB,IAAd,IAAsB,IAAtC,EAA4C;AAC1C,YAAIY,WAAW,GAAGJ,YAAY,CAACT,QAAQ,CAACvB,IAAT,CAAcA,IAAd,CAAmBA,IAApB,CAA9B;AACAC,QAAAA,OAAO,CAACmC,WAAD,CAAP;AACAjC,QAAAA,QAAQ,CAACoB,QAAQ,CAACvB,IAAT,CAAcA,IAAd,CAAmBqC,KAApB,CAAR;AACAtD,QAAAA,UAAU,CAAC,KAAD,CAAV;AACD;AACF,KArBH,EAsBG4C,KAtBH,CAsBUC,KAAD,IAAW;AAChBC,MAAAA,OAAO,CAACC,GAAR,CAAYF,KAAZ;AACA7C,MAAAA,UAAU,CAAC,KAAD,CAAV;AACD,KAzBH;AA0BD,GA7BD;;AA+BA,QAAMuD,iBAAiB,GAAG,CAACC,UAAD,EAAaC,OAAb,EAAsBC,MAAtB,KAAiC;AACzD,QAAI,CAACF,UAAL,EAAiB;AACjB,QAAIG,UAAU,GAAG3E,MAAjB;AACA2E,IAAAA,UAAU,GAAG,EACX,GAAGA,UADQ;AAEXnF,MAAAA,IAAI,EAAEgF,UAAU,CAACL,OAFN;AAGX1E,MAAAA,KAAK,EAAE+E,UAAU,CAACI;AAHP,KAAb;;AAKA,QAAIH,OAAO,IAAII,MAAM,CAACC,IAAP,CAAYL,OAAZ,EAAqBM,MAApC,EAA4C;AAC1C,UAAIN,OAAO,CAACO,QAAR,IAAoBP,OAAO,CAACO,QAAR,CAAiBD,MAAzC,EAAiD;AAC/CJ,QAAAA,UAAU,CAACvG,IAAX,CAAgB4G,QAAhB,GAA2BP,OAAO,CAACO,QAAnC;AACD,OAFD,MAEO,IAAIL,UAAU,CAACvG,IAAX,CAAgB4G,QAApB,EAA8B;AACnC,eAAOL,UAAU,CAACvG,IAAX,CAAgB,UAAhB,CAAP;AACD;;AACDuG,MAAAA,UAAU,CAACnF,IAAX,GAAkB,CAAlB;AACD,KAPD,MAOO,CACL;AACA;AACA;AACD;;AACDS,IAAAA,SAAS,CAAC0E,UAAD,CAAT;AACD,GArBD;;AAuBA,QAAMM,gBAAgB,GAAIC,IAAD,IAAU;AACjC,QAAIA,IAAJ,EAAU;AACRjF,MAAAA,SAAS,CAAEkF,UAAD,KAAiB,EAAE,GAAGA,UAAL;AAAiB1F,QAAAA,KAAK,EAAEyF,IAAxB;AAA8B1F,QAAAA,IAAI,EAAE;AAApC,OAAjB,CAAD,CAAT;AACD;AACF,GAJD;;AAMA,QAAMmD,WAAW,GAAG,MAAM;AACxB,QAAI;AAAEI,MAAAA,MAAF;AAAUD,MAAAA,GAAV;AAAeE,MAAAA;AAAf,QAA2B7F,cAA/B;AACAK,IAAAA,KAAK,CAAC;AAAEsF,MAAAA,GAAF;AAAOC,MAAAA,MAAP;AAAeC,MAAAA;AAAf,KAAD,CAAL,CACGO,IADH,CACSC,QAAD,IAAc;AAClB,UAAIA,QAAQ,CAACvB,IAAT,CAAcwB,IAAd,IAAsB,IAA1B,EAAgC;AAC9B7B,QAAAA,aAAa,CAAC4B,QAAQ,CAACvB,IAAT,CAAcA,IAAd,CAAmBA,IAApB,CAAb;AACD;AACF,KALH,EAMG2B,KANH,CAMUC,KAAD,IAAW;AAChB1H,MAAAA,KAAK,CAAC0H,KAAN,CAAYA,KAAZ;AACD,KARH;AASD,GAXD;;AAaA,QAAMuB,uBAAuB,GAAIC,MAAD,IAAY;AAC1C,QAAI,CAAAA,MAAM,SAAN,IAAAA,MAAM,WAAN,YAAAA,MAAM,CAAElF,GAAR,MAAekF,MAAf,aAAeA,MAAf,uBAAeA,MAAM,CAAE/B,WAAR,CAAoByB,MAAnC,CAAJ,EAA+C;AAC7CnE,MAAAA,WAAW,CAACyE,MAAD,aAACA,MAAD,uBAACA,MAAM,CAAE/B,WAAT,CAAX;AACD,KAFD,MAEO;AACL1C,MAAAA,WAAW,CAAC,IAAD,CAAX;AACD;;AACDJ,IAAAA,oBAAoB,CAAC,IAAD,CAApB;AACAM,IAAAA,cAAc,CAACuE,MAAD,CAAd;AACD,GARD;;AAUA,QAAMC,sBAAsB,GAAG,MAAM;AACnChE,IAAAA,mBAAmB,CAAC,KAAD,CAAnB;AACAE,IAAAA,eAAe,CAAC,KAAD,CAAf;AACAJ,IAAAA,mBAAmB,CAAC,IAAD,CAAnB;AACD,GAJD;;AAMA,QAAMmE,sBAAsB,GAAG,MAAM;AACnCnE,IAAAA,mBAAmB,CAAC,KAAD,CAAnB;AACAI,IAAAA,eAAe,CAAC,KAAD,CAAf;AACAF,IAAAA,mBAAmB,CAAC,IAAD,CAAnB;AACD,GAJD;;AAMA,QAAMkE,kBAAkB,GAAG,MAAM;AAC/BpE,IAAAA,mBAAmB,CAAC,KAAD,CAAnB;AACAE,IAAAA,mBAAmB,CAAC,KAAD,CAAnB;AACAE,IAAAA,eAAe,CAAC,IAAD,CAAf;AACD,GAJD;;AAMA,QAAMiE,mBAAmB,GAAIC,KAAD,IAAW;AACrCxE,IAAAA,aAAa,CAAC,IAAD,CAAb;AACA,QAAI;AAAE6B,MAAAA,MAAF;AAAUD,MAAAA,GAAV;AAAeE,MAAAA;AAAf,QAA2BjG,aAA/B;AACAS,IAAAA,KAAK,CAAC;AAAEuF,MAAAA,MAAF;AAAUD,MAAAA,GAAV;AAAeb,MAAAA,IAAI,EAAEyD,KAArB;AAA4B1C,MAAAA;AAA5B,KAAD,CAAL,CACGO,IADH,CACStB,IAAD,IAAU;AACd,UAAIA,IAAI,IAAIA,IAAI,CAACA,IAAL,CAAUwB,IAAV,IAAkB,IAA9B,EAAoC;AAClCvC,QAAAA,aAAa,CAAC,KAAD,CAAb;AACAd,QAAAA,WAAW;AACXE,QAAAA,UAAU,CAAC,KAAD,CAAV;AACAnE,QAAAA,KAAK,CAACuH,OAAN,CAAczB,IAAI,CAACA,IAAL,CAAU0B,OAAxB;AACAf,QAAAA,KAAK;AACN;AACF,KATH,EAUGgB,KAVH,CAUUC,KAAD,IAAW;AAChB3C,MAAAA,aAAa,CAAC,KAAD,CAAb;AACA/E,MAAAA,KAAK,CAAC0H,KAAN,CAAYA,KAAZ;AACD,KAbH;AAcD,GAjBD;;AAmBA,QAAM8B,mBAAmB,GAAID,KAAD,IAAW;AACrCxE,IAAAA,aAAa,CAAC,IAAD,CAAb;AACA,QAAI;AAAE6B,MAAAA,MAAF;AAAUD,MAAAA,GAAV;AAAeE,MAAAA;AAAf,QAA2BjG,aAA/B;AACAS,IAAAA,KAAK,CAAC;AAAEuF,MAAAA,MAAF;AAAUD,MAAAA,GAAV;AAAeb,MAAAA,IAAI,EAAEyD,KAArB;AAA4B1C,MAAAA;AAA5B,KAAD,CAAL,CACGO,IADH,CACStB,IAAD,IAAU;AACd,UAAIA,IAAI,IAAIA,IAAI,CAACA,IAAL,CAAUwB,IAAV,IAAkB,IAA9B,EAAoC;AAClCvC,QAAAA,aAAa,CAAC,KAAD,CAAb;AACAd,QAAAA,WAAW;AACXE,QAAAA,UAAU,CAAC,KAAD,CAAV;AACAnE,QAAAA,KAAK,CAACuH,OAAN,CAAczB,IAAI,CAACA,IAAL,CAAU0B,OAAxB;AACAf,QAAAA,KAAK;AACN;AACF,KATH,EAUGgB,KAVH,CAUUC,KAAD,IAAW;AAChB3C,MAAAA,aAAa,CAAC,KAAD,CAAb;AACA/E,MAAAA,KAAK,CAAC0H,KAAN,CAAYA,KAAZ;AACD,KAbH;AAcD,GAjBD;;AAmBA,QAAM+B,eAAe,GAAIF,KAAD,IAAW;AACjCxE,IAAAA,aAAa,CAAC,IAAD,CAAb;AACA,QAAI;AAAE6B,MAAAA,MAAF;AAAUD,MAAAA,GAAV;AAAeE,MAAAA;AAAf,QAA2BjG,aAA/B;AACAS,IAAAA,KAAK,CAAC;AAAEuF,MAAAA,MAAF;AAAUD,MAAAA,GAAV;AAAeb,MAAAA,IAAI,EAAEyD,KAArB;AAA4B1C,MAAAA;AAA5B,KAAD,CAAL,CACGO,IADH,CACStB,IAAD,IAAU;AACd,UAAIA,IAAI,IAAIA,IAAI,CAACA,IAAL,CAAUwB,IAAV,IAAkB,IAA9B,EAAoC;AAClCvC,QAAAA,aAAa,CAAC,KAAD,CAAb;AACAd,QAAAA,WAAW;AACXE,QAAAA,UAAU,CAAC,KAAD,CAAV;AACAnE,QAAAA,KAAK,CAACuH,OAAN,CAAczB,IAAI,CAACA,IAAL,CAAU0B,OAAxB;AACAf,QAAAA,KAAK;AACN;AACF,KATH,EAUGgB,KAVH,CAUUC,KAAD,IAAW;AAChB3C,MAAAA,aAAa,CAAC,KAAD,CAAb;AACA/E,MAAAA,KAAK,CAAC0H,KAAN,CAAYA,KAAZ;AACD,KAbH;AAcD,GAjBD;;AAmBA,QAAMgC,YAAY,GAAIH,KAAD,IAAW;AAC9B1D,IAAAA,cAAc,CAAC0D,KAAD,CAAd;;AACA,QAAIA,KAAK,KAAKtI,YAAY,CAAC,oBAAD,CAA1B,EAAkD;AAChD,aAAOkI,sBAAsB,EAA7B;AACD,KAFD,MAEO,IAAII,KAAK,KAAKtI,YAAY,CAAC,mBAAD,CAA1B,EAAiD;AACtD,aAAOmI,sBAAsB,EAA7B;AACD,KAFM,MAEA,IAAIG,KAAK,KAAKtI,YAAY,CAAC,cAAD,CAA1B,EAA4C;AACjD,aAAOoI,kBAAkB,EAAzB;AACD;AACF,GATD,CA9QyB,CAyRzB;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACA,MAAIM,YAAY,GAAG;AACjBxD,IAAAA,QAAQ,EAAEtE,MAAM,CAACuE,OADA;AAEjBC,IAAAA,aAAa,EAAEvE,OAAO,CAAC8H,MAAR,CAAerD;AAFb,GAAnB;AAIA,MAAIsD,eAAe,GAAG;AACpB1D,IAAAA,QAAQ,EAAEtE,MAAM,CAACuE,OADG;AAEpBC,IAAAA,aAAa,EAAEvE,OAAO,CAACgI,IAAR,CAAavD;AAFR,GAAtB;;AAKA,QAAMwD,gBAAgB,GAAIC,KAAD,IAAW;AAClCnF,IAAAA,UAAU,CAAC,IAAD,CAAV;AACApC,IAAAA,aAAa,CAACwH,QAAQ,CAACD,KAAK,CAACE,MAAN,CAAaX,KAAd,CAAT,CAAb;AACD,GAHD;;AAKA,QAAMY,UAAU,GAAG,MAAM,CACvB;AACEC,IAAAA,KAAK,EAAE,OADT;AAEEC,IAAAA,OAAO,EAAE,OAFX;AAGEC,IAAAA,SAAS,EAAE,OAHb;AAIEC,IAAAA,MAAM,EAAE,CAACC,IAAD,EAAOtB,MAAP,EAAeuB,KAAf,KACN,CAAC5G,MAAM,CAACR,IAAP,GAAc,CAAf,IAAoBQ,MAAM,CAACP,KAA3B,IAAoCmH,KAAK,GAAG,CAA5C;AALJ,GADuB,EAQvB;AACEL,IAAAA,KAAK,EAAE5H,UAAU,KAAKvB,YAAY,CAACyJ,iBAA5B,GAAgD,OAAhD,GAA0D,EADnE;AAEEJ,IAAAA,SAAS,EAAE9H,UAAU,KAAKvB,YAAY,CAACyJ,iBAA5B,GAAgD,OAAhD,GAA0D,EAFvE;AAGEH,IAAAA,MAAM,EAAE,CAACC,IAAD,EAAOtB,MAAP,kBACN,0CACGsB,IAAI,GACDhI,UAAU,KAAKvB,YAAY,CAACyJ,iBAA5B,GACEF,IADF,GAEE,EAHD,GAID,EALN;AAJJ,GARuB,EAqBvB;AACEJ,IAAAA,KAAK,EAAE5H,UAAU,KAAKvB,YAAY,CAACyJ,iBAA5B,GAAgD,UAAhD,GAA6D,EADtE;AAEEJ,IAAAA,SAAS,EACP9H,UAAU,KAAKvB,YAAY,CAACyJ,iBAA5B,GAAgD,UAAhD,GAA6D,EAHjE;AAIEH,IAAAA,MAAM,EAAE,CAACC,IAAD,EAAOtB,MAAP,kBAAkB,0CAAGsB,IAAI,GAAGA,IAAI,CAACG,IAAR,GAAe,EAAtB;AAJ5B,GArBuB,EA2BvB;AACEP,IAAAA,KAAK,EAAE,OADT;AAEEE,IAAAA,SAAS,EAAE,OAFb;AAGEC,IAAAA,MAAM,EAAE,CAACC,IAAD,EAAOtB,MAAP,kBAAkB,0CAAGsB,IAAI,GAAGA,IAAH,GAAU,KAAjB;AAH5B,GA3BuB,EAgCvB;AACEJ,IAAAA,KAAK,EAAE5H,UAAU,IAAIvB,YAAY,CAAC2J,YAA3B,GAA0C,UAA1C,GAAuD,EADhE;AAEEN,IAAAA,SAAS,EAAE9H,UAAU,IAAIvB,YAAY,CAAC2J,YAA3B,GAA0C,UAA1C,GAAuD,EAFpE;AAGEL,IAAAA,MAAM,EAAE,CAACC,IAAD,EAAOtB,MAAP,kBACN,0CACGsB,IAAI,GACD9B,MAAM,CAACC,IAAP,CAAYxH,WAAZ,EAAyB4F,GAAzB,CAA8B8D,MAAD,IAAY;AACzC,aAAO1J,WAAW,CAAC0J,MAAD,CAAX,KAAwBL,IAAxB,GAA+BK,MAA/B,GAAwC,EAA/C;AACD,KAFC,CADC,GAID,EALN;AAJJ,GAhCuB,EA6CvB;AACET,IAAAA,KAAK,EACH5H,UAAU,IAAIvB,YAAY,CAACyB,kBAA3B,IACEF,UAAU,IAAIvB,YAAY,CAAC2J,YAD7B,GAEI,SAFJ,GAGI,EALR;AAMEN,IAAAA,SAAS,EACP9H,UAAU,IAAIvB,YAAY,CAACyB,kBAA3B,IACEF,UAAU,IAAIvB,YAAY,CAAC2J,YAD7B,GAEI,SAFJ,GAGI,EAVR;AAWEL,IAAAA,MAAM,EAAGC,IAAD,IACNA,IAAI,GACA9B,MAAM,CAACC,IAAP,CAAYzH,OAAZ,EAAqB6F,GAArB,CAA0B+D,OAAD,IAAa;AACtC,0BACE;AAAM,QAAA,KAAK,EAAE;AAAEC,UAAAA,KAAK,EAAEP,IAAI,IAAItJ,OAAO,CAAC8J,IAAhB,GAAuB,KAAvB,GAA+B;AAAxC,SAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACG9J,OAAO,CAAC4J,OAAD,CAAP,KAAqBN,IAArB,GAA4BM,OAA5B,GAAsC,EADzC,CADF;AAKD,KANC,CADA,GAQA;AApBR,GA7CuB,EAmEvB;AACEV,IAAAA,KAAK,EACH5H,UAAU,IAAIvB,YAAY,CAACyB,kBAA3B,IACEF,UAAU,IAAIvB,YAAY,CAACyJ,iBAD7B,GAEI,WAFJ,GAGI,EALR;AAMEJ,IAAAA,SAAS,EACP9H,UAAU,IAAIvB,YAAY,CAACyB,kBAA3B,IACEF,UAAU,IAAIvB,YAAY,CAACyJ,iBAD7B,GAEI,SAFJ,GAGI,EAVR;AAWEH,IAAAA,MAAM,EAAGC,IAAD,iBACN;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAOA,IAAI,GAAI,GAAEA,IAAI,CAACS,QAAS,IAAGT,IAAI,CAACU,SAAU,EAAtC,GAA0C,EAArD;AAZJ,GAnEuB,EAkFvB;AACEd,IAAAA,KAAK,EACH5H,UAAU,IAAIvB,YAAY,CAACyB,kBAA3B,IACEF,UAAU,IAAIvB,YAAY,CAACyJ,iBAD7B,GAEI,MAFJ,GAGI,EALR;AAMEJ,IAAAA,SAAS,EACP9H,UAAU,IAAIvB,YAAY,CAACyB,kBAA3B,IACEF,UAAU,IAAIvB,YAAY,CAACyJ,iBAD7B,GAEI,WAFJ,GAGI,EAVR;AAWEH,IAAAA,MAAM,EAAGC,IAAD,iBACN;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAOA,IAAI,GAAGxI,MAAM,CAACwI,IAAD,CAAN,CAAaW,MAAb,CAAoB,mBAApB,CAAH,GAA8C,EAAzD;AAZJ,GAlFuB,EAiGvB;AACEf,IAAAA,KAAK,EACH5H,UAAU,IAAIvB,YAAY,CAACyJ,iBAA3B,GAA+C,iBAA/C,GAAmE,EAFvE;AAGEJ,IAAAA,SAAS,EACP9H,UAAU,IAAIvB,YAAY,CAACyJ,iBAA3B,GAA+C,aAA/C,GAA+D,EAJnE;AAKEH,IAAAA,MAAM,EAAE,CAACrB,MAAD,EAASsB,IAAT,KACNhI,UAAU,IAAIvB,YAAY,CAACyJ,iBAA3B,gBACE,uDACE;AACE,MAAA,OAAO,EAAE,MAAM;AACbzB,QAAAA,uBAAuB,CAACuB,IAAD,CAAvB;AACD,OAHH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAKE,oBAAC,IAAD;AACE,MAAA,KAAK,EAAE;AACLY,QAAAA,SAAS,EAAE,MADN;AAELC,QAAAA,WAAW,EAAE,MAFR;AAGLC,QAAAA,MAAM,EAAE,SAHH;AAILC,QAAAA,KAAK,EAAE,MAJF;AAKLC,QAAAA,MAAM,EAAE;AALH,OADT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MALF,CADF,CADF,GAmBI;AAzBR,GAjGuB,EA6HvB;AACEpB,IAAAA,KAAK,EAAE,QADT;AAEEqB,IAAAA,WAAW,EAAE,IAFf;AAGElB,IAAAA,MAAM,EAAE,CAACC,IAAD,EAAOtB,MAAP,kBACN,uDACE;AAAK,MAAA,SAAS,EAAC,SAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAUGtH,gBAAgB,CAAC+H,YAAD,CAAhB,gBACC;AACE,MAAA,OAAO,EAAE,MAAM;AACbpE,QAAAA,cAAc,CAAC,IAAD,CAAd;AACAI,QAAAA,SAAS,CAACuD,MAAD,CAAT;AACD,OAJH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAME,oBAAC,MAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MANF,eAOE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAPF,CADD,GAUG,IApBN,EAqBGA,MAAM,IAAIA,MAAM,CAAC/B,WAAjB,IAAgCjF,CAAC,CAAC6G,IAAF,CAAOG,MAAM,CAAC/B,WAAd,IAA6B,CAA7D,gBACC;AAAM,MAAA,OAAO,EAAE,MAAM;AAAEuE,QAAAA,gBAAgB,CAAC,IAAD,EAAOxC,MAAP,CAAhB;AAAgC,OAAvD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE,oBAAC,IAAD;AAAM,MAAA,KAAK,EAAE;AAAEoC,QAAAA,MAAM,EAAE;AAAV,OAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,CADD,GAIG,IAzBN,CADF;AAJJ,GA7HuB,CAAzB;;AAkKA,QAAMK,YAAY,GAAIC,EAAD,IAAQ;AAC3B,QAAI;AAAEhF,MAAAA,MAAF;AAAUD,MAAAA,GAAV;AAAeE,MAAAA;AAAf,QAA2B/F,aAA/B;AACA6F,IAAAA,GAAG,GAAI,GAAEA,GAAI,IAAGiF,EAAG,EAAnB;AACAvK,IAAAA,KAAK,CAAC;AAAEuF,MAAAA,MAAF;AAAUD,MAAAA,GAAV;AAAeE,MAAAA;AAAf,KAAD,CAAL,CACGO,IADH,CACSC,QAAD,IAAc;AAClB9B,MAAAA,cAAc,CAAC,KAAD,CAAd;AACAkB,MAAAA,KAAK;AACN,KAJH,EAKGgB,KALH,CAKUC,KAAD,IAAW;AAChB1H,MAAAA,KAAK,CAAC0H,KAAN,CAAYA,KAAZ;AACD,KAPH;AAQD,GAXD;;AAaA,QAAMgE,gBAAgB,GAAG,CAACG,MAAD,EAAS3C,MAAT,KAAoB;AAC3CtG,IAAAA,eAAe,CAACiJ,MAAD,CAAf;;AACA,QAAI3C,MAAJ,aAAIA,MAAJ,uBAAIA,MAAM,CAAE/B,WAAZ,EAAyB;AACvBjF,MAAAA,CAAC,CAAC6E,GAAF,CAAMmC,MAAN,aAAMA,MAAN,uBAAMA,MAAM,CAAE/B,WAAd,EAA4BH,GAAD,IAAS;AAClCA,QAAAA,GAAG,CAAC8E,OAAJ,GAAe,GAAE5C,MAAM,CAACkB,KAAM,EAA9B;AACApD,QAAAA,GAAG,CAAC+E,GAAJ,GAAU/E,GAAV,aAAUA,GAAV,uBAAUA,GAAG,CAAEC,IAAf;AACD,OAHD;;AAIAnE,MAAAA,SAAS,CAACoG,MAAD,aAACA,MAAD,uBAACA,MAAM,CAAE/B,WAAT,CAAT;AACD;AACF,GATD;;AAWA,sBACE,uDACE;AAAK,IAAA,SAAS,EAAC,UAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AAAK,IAAA,SAAS,EAAC,WAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,MAAD;AACE,IAAA,KAAK,EAAEnB,KADT;AAEE,IAAA,YAAY,EAAExD,UAFhB;AAGE,IAAA,SAAS,EAAEqF,sBAHb;AAIE,IAAA,kBAAkB,EAAEkC,gBAJtB;AAKE,IAAA,gBAAgB,EAAE7D,cALpB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,eAQE,oBAAC,KAAD;AACE,IAAA,OAAO,EAAEtE,gBAAgB,CAACiI,eAAD,CAAhB,GAAoCM,UAAU,EAA9C,GAAmD,IAD9D;AAEE,IAAA,UAAU,EAAErE,IAFd;AAGE,IAAA,OAAO,EAAElB,OAHX;AAIE,IAAA,QAAQ,EAAEwD,iBAJZ;AAKE,IAAA,UAAU,EAAE;AACVJ,MAAAA,OAAO,EAAEnE,MAAM,CAACR,IADN;AAEVoF,MAAAA,QAAQ,EAAE5E,MAAM,CAACP,KAFP;AAGV0C,MAAAA,KAAK,EAAEA,KAHG;AAIVgG,MAAAA,eAAe,EAAE,IAJP;AAKVlD,MAAAA,gBAAgB,EAAEA;AALR,KALd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IARF,CADF,CADF,EA0BG5E,OAAO,iBACN,oBAAC,MAAD;AACE,IAAA,OAAO,EAAEA,OADX;AAEE,IAAA,YAAY,EAAE,KAFhB;AAGE,IAAA,OAAO,EAAE,MAAM;AACbC,MAAAA,UAAU,CAAC,KAAD,CAAV;AACD,KALH;AAME,IAAA,QAAQ,EAAE,MAAM;AACdA,MAAAA,UAAU,CAAC,KAAD,CAAV;AACD,KARH;AASE,IAAA,KAAK,EAAE;AAAEoH,MAAAA,KAAK,EAAE;AAAT,KATT;AAUE,IAAA,SAAS,EAAC,mBAVZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAYE;AAAK,IAAA,SAAS,EAAC,kBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AAAI,IAAA,SAAS,EAAC,qBAAd;AAAoC,IAAA,KAAK,EAAE;AAAER,MAAAA,KAAK,EAAE;AAAT,KAA3C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eADF,eAKE;AAAK,IAAA,SAAS,EAAC,kBAAf;AAAkC,IAAA,KAAK,EAAE;AAAEkB,MAAAA,YAAY,EAAE;AAAhB,KAAzC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACGvD,MAAM,CAACC,IAAP,CAAY1H,YAAZ,EAA0B8F,GAA1B,CAA8B,CAAC4D,IAAD,EAAOF,KAAP,KAAiB;AAC9C,wBACE,uDACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE,oBAAC,MAAD;AACE,MAAA,SAAS,EACP7E,WAAW,KAAK3E,YAAY,CAAC0J,IAAD,CAA5B,GAAqC,SAArC,GAAiD,IAFrD;AAIE,MAAA,OAAO,EAAE,MAAM;AACbjB,QAAAA,YAAY,CAACzI,YAAY,CAAC0J,IAAD,CAAb,CAAZ;AACD,OANH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAQGA,IAAI,CAACuB,OAAL,CAAa,IAAb,EAAmB,GAAnB,CARH,CADF,CADF,CADF;AAgBD,GAjBA,CADH,CALF,EA0BGlH,gBAAgB,iBACf,oBAAC,gBAAD,CACE;AADF;AAEE,IAAA,WAAW,EAAEY,WAFf;AAGE,IAAA,QAAQ,EAAE0D,mBAHZ;AAIE,IAAA,YAAY,EAAE,MAAM;AAClBrF,MAAAA,WAAW;AACXE,MAAAA,UAAU,CAAC,KAAD,CAAV;AACD,KAPH;AAQE,IAAA,IAAI,EAAE7B,IARR;AASE,IAAA,OAAO,EAAEwC,UATX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IA3BJ,EAuCGI,gBAAgB,iBACf,oBAAC,kBAAD;AACE,IAAA,UAAU,EAAEM,aADd;AAEE,IAAA,WAAW,EAAEI,WAFf;AAGE,IAAA,YAAY,EAAE,MAAM;AAClB3B,MAAAA,WAAW;AACXE,MAAAA,UAAU,CAAC,KAAD,CAAV;AACD,KANH;AAOE,IAAA,YAAY,EAAEqF,mBAPhB;AAQE,IAAA,IAAI,EAAElH,IARR;AASE,IAAA,OAAO,EAAEwC,UATX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAxCJ,EAoDGM,YAAY,iBACX,oBAAC,QAAD;AACE,IAAA,QAAQ,EAAE7C,QADZ;AAEE,IAAA,WAAW,EAAEqD,WAFf;AAGE,IAAA,YAAY,EAAE,MAAM;AAClB3B,MAAAA,WAAW;AACXE,MAAAA,UAAU,CAAC,KAAD,CAAV;AACD,KANH;AAOE,IAAA,YAAY,EAAEsF,eAPhB;AAQE,IAAA,IAAI,EAAEnH,IARR;AASE,IAAA,OAAO,EAAEwC,UATX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IArDJ,CAZF,eA+EE;AACE,IAAA,SAAS,EAAC,WADZ;AAEE,IAAA,OAAO,EAAE,MAAM;AACbX,MAAAA,UAAU,CAAC,KAAD,CAAV;AACD,KAJH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAME;AACE,IAAA,GAAG,EAAC,GADN;AAEE,IAAA,GAAG,EAAEhC,OAAO,CAAC,4CAAD,CAFd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IANF,CA/EF,CA3BJ,EAwHGmD,WAAW,iBACV,oBAAC,YAAD;AACE,IAAA,KAAK,EAAEI,SADT;AAEE,IAAA,OAAO,EAAEJ,WAFX;AAGE,IAAA,KAAK,EAAG,kBAAiBI,SAAS,CAACuC,KAAM,EAH3C;AAIE,IAAA,WAAW,EAAC,oCAJd;AAKE,IAAA,IAAI,EAAE,MAAM;AACV0D,MAAAA,YAAY,CAACjG,SAAS,IAAIA,SAAS,CAAC1B,GAAxB,CAAZ;AACD,KAPH;AAQE,IAAA,MAAM,EAAC,KART;AASE,IAAA,UAAU,EAAC,QATb;AAUE,IAAA,OAAO,EAAE,MAAM;AACbuB,MAAAA,cAAc,CAAC,KAAD,CAAd;AACD,KAZH;AAaE,IAAA,QAAQ,EAAE,MAAM;AACdA,MAAAA,cAAc,CAAC,KAAD,CAAd;AACD,KAfH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAzHJ,EA4IGnB,iBAAiB,iBAChB,oBAAC,QAAD;AACE,IAAA,OAAO,EAAEA,iBADX;AAEE,IAAA,cAAc,EAAE,MAAMC,oBAAoB,CAAC,KAAD,CAF5C;AAGE,IAAA,QAAQ,EAAE,IAHZ;AAIE,IAAA,KAAK,EAAC,iBAJR,CAKE;AACA;AACA;AAPF;AAQE,IAAA,SAAS,EAAE,EAAE,GAAG5C;AAAL,KARb;AASE,IAAA,YAAY,EAAED,UAAU,CAAC2K,KAT3B;AAUE,IAAA,SAAS,EAAE;AACTC,MAAAA,YAAY,EAAE,IADL;AAETxI,MAAAA,QAAQ,EAAE,CAACrC,aAAa,CAAC4K,KAAf,EAAsBE,IAAtB,CAA2B,GAA3B;AAFD,KAVb;AAcE,IAAA,WAAW,EAAE,CAdf;AAeE,IAAA,OAAO,EAAGC,GAAD,IAAS;AAChBtM,MAAAA,KAAK,CAAC0H,KAAN,CAAY4E,GAAZ;AACD,KAjBH;AAkBE,IAAA,SAAS,EAAGC,QAAD,IAAc;AACvB,UAAI,CAAAA,QAAQ,SAAR,IAAAA,QAAQ,WAAR,YAAAA,QAAQ,CAAEjF,IAAV,MAAmB,IAAvB,EAA6B;AAC3B/C,QAAAA,aAAa,CAACgI,QAAQ,CAACzG,IAAV,CAAb;AACAzB,QAAAA,oBAAoB,CAAC,KAAD,CAApB;AACD;AACF,KAvBH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IA7IJ,EAwKG1B,YAAY,iBACX,oBAAC,QAAD;AACE,IAAA,OAAO,EAAEA,YADX;AAEE,IAAA,MAAM,EAAEE,MAFV;AAGE,IAAA,cAAc,EAAE,MAAM6I,gBAAgB,CAAC,KAAD,CAHxC;AAIE,IAAA,MAAM,EAAE,CAJV;AAKE,IAAA,UAAU,EAAE;AAAEI,MAAAA,OAAO,EAAE;AAAX,KALd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAzKJ,CADF;AAmLD,CAnqBD;;AAoqBA,MAAMU,eAAe,GAAG,CAAC;AAAEC,EAAAA;AAAF,CAAD,KAAc;AACpC,QAAM;AAAElK,IAAAA;AAAF,MAAekK,IAArB;AACA,SAAO;AACLlK,IAAAA;AADK,GAAP;AAGD,CALD;;AAOA,eAAenC,OAAO,CAACoM,eAAD,CAAP,CAAyB7K,UAAU,GAAGS,OAAH,CAAnC,CAAf","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { Toast, Button, LightBox } from '../../../src/components/common/index';\nimport { View } from \"../../../src/assets/images/pmr/index\";\nimport { connect } from 'react-redux';\nimport { Info } from '../../../src/assets/images/popup';\nimport Dialog from 'rc-dialog';\nimport Table from '../../../src/components/common/Table/index';\nimport ConnectWritiForm from './components/ConnectWritiForm';\nimport { Cancel } from '../../../src/assets/images/resident-detail/index';\nimport RequestFeatureForm from './components/RequestFeatureForm';\nimport BugsForm from './components/BugsForm';\nimport {\n  supportUpsert,\n  supportPaginate,\n  supportDelete,\n  supportUpdate,\n} from '../../../src/services/api/routes/supportFeedback';\nimport { masterPaginate } from '../../../src/services/api/routes/master';\nimport { SUPPORT_TYPE, URGENCY } from '../../constants/supportFeedback';\nimport { DEVICE_TYPE } from '../../constants/common';\nimport { USER_TYPE } from '../../constants/User';\nimport axios from '../../../src/services/api/config';\nimport Uploader, {\n  FILE_CATEGORY,\n  FILE_TYPES,\n} from '../../../src/components/common/Upload/Uploader';\nimport { fileUpload } from '../../../src/services/api/routes/common';\nimport Header from './components/Header';\nimport { createForm } from 'rc-form';\nimport { canPerformAction } from '../../../src/util/common';\nimport { MODULE, ACTIONS } from '../../../src/constants/subscription';\nimport ConfirmPopup from '../../../src/components/common/ConfirmPopup';\nimport moment from 'moment';\nimport { find } from 'lodash';\nconst _ = require('lodash');\n\nconst Support = (props) => {\n  const { form, authUser } = props;\n\n  const [radioValue, setRadioValue] = useState(SUPPORT_TYPE.CONNECT_WITH_WRITI);\n  const [visibleImage, setVisibleImage] = useState(false);\n  const [detail, setDetail] = useState([]);\n\n  const isAdmin =\n    authUser &&\n    (authUser.type === USER_TYPE.ADMIN.SUPER ||\n      authUser.type === USER_TYPE.ADMIN.GENERAL);\n\n  const initialFilter = {\n    page: 1,\n    limit: 10,\n    fields: [],\n    sortBy: { createdAt: 'DESC' },\n    find: {},\n    populate: [\n      {\n        addedBy: ['firstName', 'lastName', 'mergeLFName'],\n      },\n      {\n        category: ['name'],\n      },\n    ],\n  };\n\n  const [filter, setFilter] = useState(() => {\n    if (!isAdmin) {\n      _.assignIn(initialFilter.find, { addedBy: authUser._id });\n    }\n    return initialFilter;\n  });\n\n  const { resetFields } = form;\n  const [visible, setVisible] = useState(false);\n  const [attechmentVisible, setattechmentVisible] = useState(false);\n  const [attechment, setAttechment] = useState([]);\n  const [fileData, setFileData] = useState([]);\n  const [supportData, setSupportData] = useState([]);\n\n  const [loading, setLoading] = useState(false);\n  const [btnLoading, setBtnLoading] = useState(false);\n  const [openConnectModal, setOpenConnectModal] = useState(true);\n  const [openRequestModal, setOpenRequestModal] = useState(false);\n  const [openBugModal, setOpenBugModal] = useState(false);\n  const [deleteModal, setDeleteModal] = useState(false);\n  const [getMasterName, setMasterName] = useState();\n  const [getRecord, setRecord] = useState('');\n  const [supportType, setSupportType] = useState(\n    SUPPORT_TYPE.CONNECT_WITH_WRITI\n  );\n\n  const [data, setData] = useState([]);\n  const [total, setTotal] = useState('');\n\n\n  const checkAddAction = canPerformAction({\n    moduleId: MODULE.SUPPORT,\n    actiontoCheck: ACTIONS.ADD.CODE\n  })\n\n  useEffect(() => {\n    fetchMaster();\n  }, []);\n\n  useEffect(() => {\n    fetch();\n  }, [filter, radioValue]);\n\n  useEffect(() => {\n    if (attechment) {\n      handleUpdate();\n    }\n  }, [attechment]);\n\n  const handleUpdate = () => {\n    if (supportData?._id) {\n      let { url, method, baseURL } = supportUpdate;\n      url = `${url}/${supportData._id}`;\n      let imgData;\n      _.map(attechment, (img) => {\n        imgData = img?.path\n      })\n\n      let obj = {\n        attachments: [{ path: imgData }],\n      };\n      axios({ url, method, baseURL, data: obj })\n        .then((response) => {\n          if (response?.data.code == 'OK') {\n            Toast.success(response.data.message);\n            fetch();\n          }\n        })\n        .catch((error) => {\n          console.log(error);\n        });\n    }\n  };\n  const handleSupportModalOpen = () => {\n    setVisible(true);\n  };\n\n  const modifiedList = (list) => {\n    let modifiedList = list.map((current) => {\n      return current;\n    });\n    return modifiedList;\n  };\n\n  const fetch = () => {\n    setLoading(true);\n    let { method, url, baseURL } = supportPaginate;\n    axios({\n      method,\n      url,\n      baseURL,\n      data: {\n        query: {\n          ...filter,\n          find: {\n            ...filter.find,\n            type: radioValue,\n          },\n        },\n      },\n    })\n      .then((response) => {\n        if (response && response.data.code == 'OK') {\n          let updatedList = modifiedList(response.data.data.data);\n          setData(updatedList);\n          setTotal(response.data.data.count);\n          setLoading(false);\n        }\n      })\n      .catch((error) => {\n        console.log(error);\n        setLoading(false);\n      });\n  };\n\n  const handleTableChange = (pagination, tfilter, sorter) => {\n    if (!pagination) return;\n    let tempFilter = filter;\n    tempFilter = {\n      ...tempFilter,\n      page: pagination.current,\n      limit: pagination.pageSize,\n    };\n    if (tfilter && Object.keys(tfilter).length) {\n      if (tfilter.isActive && tfilter.isActive.length) {\n        tempFilter.find.isActive = tfilter.isActive;\n      } else if (tempFilter.find.isActive) {\n        delete tempFilter.find['isActive'];\n      }\n      tempFilter.page = 1;\n    } else {\n      // tempFilter.filter = {\n      //     type: tempFilter.filter.type\n      // }\n    }\n    setFilter(tempFilter);\n  };\n\n  const onShowSizeChange = (size) => {\n    if (size) {\n      setFilter((prevFilter) => ({ ...prevFilter, limit: size, page: 1 }));\n    }\n  };\n\n  const fetchMaster = () => {\n    let { method, url, baseURL } = masterPaginate;\n    axios({ url, method, baseURL })\n      .then((response) => {\n        if (response.data.code == 'OK') {\n          setMasterName(response.data.data.data);\n        }\n      })\n      .catch((error) => {\n        Toast.error(error);\n      });\n  };\n\n  const handleAttechmentVisible = (record) => {\n    if (record?._id && record?.attachments.length) {\n      setFileData(record?.attachments);\n    } else {\n      setFileData(null);\n    }\n    setattechmentVisible(true);\n    setSupportData(record);\n  };\n\n  const handleOpenConnectModal = () => {\n    setOpenRequestModal(false);\n    setOpenBugModal(false);\n    setOpenConnectModal(true);\n  };\n\n  const handleOpenRequestModal = () => {\n    setOpenConnectModal(false);\n    setOpenBugModal(false);\n    setOpenRequestModal(true);\n  };\n\n  const handleOpenBugModal = () => {\n    setOpenConnectModal(false);\n    setOpenRequestModal(false);\n    setOpenBugModal(true);\n  };\n\n  const handleConnectSubmit = (value) => {\n    setBtnLoading(true);\n    let { method, url, baseURL } = supportUpsert;\n    axios({ method, url, data: value, baseURL })\n      .then((data) => {\n        if (data && data.data.code == 'OK') {\n          setBtnLoading(false);\n          resetFields();\n          setVisible(false);\n          Toast.success(data.data.message);\n          fetch();\n        }\n      })\n      .catch((error) => {\n        setBtnLoading(false);\n        Toast.error(error);\n      });\n  };\n\n  const handleRequestSubmit = (value) => {\n    setBtnLoading(true);\n    let { method, url, baseURL } = supportUpsert;\n    axios({ method, url, data: value, baseURL })\n      .then((data) => {\n        if (data && data.data.code == 'OK') {\n          setBtnLoading(false);\n          resetFields();\n          setVisible(false);\n          Toast.success(data.data.message);\n          fetch();\n        }\n      })\n      .catch((error) => {\n        setBtnLoading(false);\n        Toast.error(error);\n      });\n  };\n\n  const handleBugSubmit = (value) => {\n    setBtnLoading(true);\n    let { method, url, baseURL } = supportUpsert;\n    axios({ method, url, data: value, baseURL })\n      .then((data) => {\n        if (data && data.data.code == 'OK') {\n          setBtnLoading(false);\n          resetFields();\n          setVisible(false);\n          Toast.success(data.data.message);\n          fetch();\n        }\n      })\n      .catch((error) => {\n        setBtnLoading(false);\n        Toast.error(error);\n      });\n  };\n\n  const handleSubmit = (value) => {\n    setSupportType(value);\n    if (value === SUPPORT_TYPE['CONNECT_WITH_WRITI']) {\n      return handleOpenConnectModal();\n    } else if (value === SUPPORT_TYPE['REQUEST_A_FEATURE']) {\n      return handleOpenRequestModal();\n    } else if (value === SUPPORT_TYPE['SUBMIT_A_BUG']) {\n      return handleOpenBugModal();\n    }\n  };\n\n  // const handleUpdate = () => {\n  //   const { url, method, baseURL } = supportUpdate;\n  //   url = `${url}/${supportData._id}`;\n  //   let obj = {\n  //     attachments: data.path,\n  //   };\n\n  //   axios({ url, method, baseURL, data: obj })\n  //     .then((response) => {\n  //       console.log('response', response);\n  //     })\n  //     .catch((error) => {\n  //       console.log(error);\n  //     });\n  // };\n  let deleteParams = {\n    moduleId: MODULE.SUPPORT,\n    actiontoCheck: ACTIONS.DELETE.CODE,\n  };\n  let tableListParams = {\n    moduleId: MODULE.SUPPORT,\n    actiontoCheck: ACTIONS.LIST.CODE,\n  };\n\n  const handleRadioValue = (event) => {\n    setLoading(true);\n    setRadioValue(parseInt(event.target.value));\n  };\n\n  const getColumns = () => [\n    {\n      title: 'Sr.No',\n      keyword: 'index',\n      dataIndex: 'index',\n      render: (text, record, index) =>\n        (filter.page - 1) * filter.limit + (index + 1),\n    },\n    {\n      title: radioValue === SUPPORT_TYPE.REQUEST_A_FEATURE ? 'Title' : '',\n      dataIndex: radioValue === SUPPORT_TYPE.REQUEST_A_FEATURE ? 'title' : '',\n      render: (text, record) => (\n        <>\n          {text\n            ? radioValue === SUPPORT_TYPE.REQUEST_A_FEATURE\n              ? text\n              : ''\n            : ''}\n        </>\n      ),\n    },\n    {\n      title: radioValue === SUPPORT_TYPE.REQUEST_A_FEATURE ? 'Category' : '',\n      dataIndex:\n        radioValue === SUPPORT_TYPE.REQUEST_A_FEATURE ? 'category' : '',\n      render: (text, record) => <>{text ? text.name : ''}</>,\n    },\n    {\n      title: 'Query',\n      dataIndex: 'query',\n      render: (text, record) => <>{text ? text : ' - '}</>,\n    },\n    {\n      title: radioValue == SUPPORT_TYPE.SUBMIT_A_BUG ? 'Platform' : '',\n      dataIndex: radioValue == SUPPORT_TYPE.SUBMIT_A_BUG ? 'platform' : '',\n      render: (text, record) => (\n        <>\n          {text\n            ? Object.keys(DEVICE_TYPE).map((device) => {\n              return DEVICE_TYPE[device] === text ? device : '';\n            })\n            : ''}\n        </>\n      ),\n    },\n    {\n      title:\n        radioValue == SUPPORT_TYPE.CONNECT_WITH_WRITI ||\n          radioValue == SUPPORT_TYPE.SUBMIT_A_BUG\n          ? 'Urgency'\n          : '',\n      dataIndex:\n        radioValue == SUPPORT_TYPE.CONNECT_WITH_WRITI ||\n          radioValue == SUPPORT_TYPE.SUBMIT_A_BUG\n          ? 'urgency'\n          : '',\n      render: (text) =>\n        text\n          ? Object.keys(URGENCY).map((urgency) => {\n            return (\n              <span style={{ color: text == URGENCY.HIGH ? 'Red' : 'Black' }}>\n                {URGENCY[urgency] === text ? urgency : ''}\n              </span>\n            );\n          })\n          : '',\n    },\n    {\n      title:\n        radioValue == SUPPORT_TYPE.CONNECT_WITH_WRITI ||\n          radioValue == SUPPORT_TYPE.REQUEST_A_FEATURE\n          ? 'RequestBy'\n          : '',\n      dataIndex:\n        radioValue == SUPPORT_TYPE.CONNECT_WITH_WRITI ||\n          radioValue == SUPPORT_TYPE.REQUEST_A_FEATURE\n          ? 'addedBy'\n          : '',\n      render: (text) => (\n        <span>{text ? `${text.lastName},${text.firstName}` : ''}</span>\n      ),\n    },\n    {\n      title:\n        radioValue == SUPPORT_TYPE.CONNECT_WITH_WRITI ||\n          radioValue == SUPPORT_TYPE.REQUEST_A_FEATURE\n          ? 'Date'\n          : '',\n      dataIndex:\n        radioValue == SUPPORT_TYPE.CONNECT_WITH_WRITI ||\n          radioValue == SUPPORT_TYPE.REQUEST_A_FEATURE\n          ? 'createdAt'\n          : '',\n      render: (text) => (\n        <span>{text ? moment(text).format('MM/DD/YYYY, HH:mm') : ''}</span>\n      ),\n    },\n    {\n      title:\n        radioValue == SUPPORT_TYPE.REQUEST_A_FEATURE ? 'View Attechment' : '',\n      dataIndex:\n        radioValue == SUPPORT_TYPE.REQUEST_A_FEATURE ? 'attachments' : '',\n      render: (record, text) =>\n        radioValue == SUPPORT_TYPE.REQUEST_A_FEATURE ? (\n          <>\n            <span\n              onClick={() => {\n                handleAttechmentVisible(text);\n              }}\n            >\n              <Info\n                style={{\n                  marginTop: '-7px',\n                  marginRight: '45px',\n                  cursor: 'pointer',\n                  width: '20px',\n                  height: '20px',\n                }}\n              />\n            </span>\n\n          </>\n        ) : null,\n    },\n\n    {\n      title: 'Action',\n      showRefresh: true,\n      render: (text, record) => (\n        <>\n          <div className='actions'>\n            {/* <a\n              onClick={() => {\n                setVisible(true);\n                setRecord(record);\n              }}\n            >\n              <Edit />\n              <p>Edit</p>\n            </a> */}\n            {canPerformAction(deleteParams) ? (\n              <a\n                onClick={() => {\n                  setDeleteModal(true);\n                  setRecord(record);\n                }}\n              >\n                <Cancel />\n                <p>Delete</p>\n              </a>\n            ) : null}\n            {record && record.attachments && _.size(record.attachments) > 0 ?\n              <span onClick={() => { handleViewImages(true, record) }}>\n                <View style={{ cursor: 'pointer', }} />\n              </span>\n              : null}\n          </div>\n        </>\n      ),\n    },\n  ];\n\n  const handleDelete = (id) => {\n    let { method, url, baseURL } = supportDelete;\n    url = `${url}/${id}`;\n    axios({ method, url, baseURL })\n      .then((response) => {\n        setDeleteModal(false);\n        fetch();\n      })\n      .catch((error) => {\n        Toast.error(error);\n      });\n  };\n\n  const handleViewImages = (action, record) => {\n    setVisibleImage(action);\n    if (record?.attachments) {\n      _.map(record?.attachments, (img) => {\n        img.caption = `${record.title}`;\n        img.src = img?.path\n      })\n      setDetail(record?.attachments);\n    }\n  }\n\n  return (\n    <>\n      <div className='pmr_wrap'>\n        <div className='container'>\n          <Header\n            total={total}\n            onRadioValue={radioValue}\n            onVisible={handleSupportModalOpen}\n            onHandleRadioValue={handleRadioValue}\n            onCheckAddAction={checkAddAction}\n          />\n          <Table\n            columns={canPerformAction(tableListParams) ? getColumns() : null}\n            datasource={data}\n            loading={loading}\n            onChange={handleTableChange}\n            pagination={{\n              current: filter.page,\n              pageSize: filter.limit,\n              total: total,\n              showSizeChanger: true,\n              onShowSizeChange: onShowSizeChange,\n            }}\n          />\n        </div>\n      </div>\n\n      {visible && (\n        <Dialog\n          visible={visible}\n          maskClosable={false}\n          onClose={() => {\n            setVisible(false);\n          }}\n          onCancel={() => {\n            setVisible(false);\n          }}\n          style={{ width: '50%' }}\n          className='search_popup_wrap'\n        >\n          <div className='popup-search-con'>\n            <h2 className='name_head text-left' style={{ color: '#000000' }}>\n              Support\n            </h2>\n\n            <div className='rx-btns drug-bts' style={{ marginBottom: '3%' }}>\n              {Object.keys(SUPPORT_TYPE).map((name, index) => {\n                return (\n                  <>\n                    <a>\n                      <Button\n                        className={\n                          supportType === SUPPORT_TYPE[name] ? 'r-o-btn' : null\n                        }\n                        onClick={() => {\n                          handleSubmit(SUPPORT_TYPE[name]);\n                        }}\n                      >\n                        {name.replace(/_/g, ' ')}\n                      </Button>\n                    </a>\n                  </>\n                );\n              })}\n            </div>\n\n            {openConnectModal && (\n              <ConnectWritiForm\n                // editRecord={getRecord ? getRecord : null}\n                supportType={supportType}\n                onSubmit={handleConnectSubmit}\n                handleCancel={() => {\n                  resetFields();\n                  setVisible(false);\n                }}\n                form={form}\n                loading={btnLoading}\n              />\n            )}\n            {openRequestModal && (\n              <RequestFeatureForm\n                masterData={getMasterName}\n                supportType={supportType}\n                handleCancel={() => {\n                  resetFields();\n                  setVisible(false);\n                }}\n                handleSubmit={handleRequestSubmit}\n                form={form}\n                loading={btnLoading}\n              />\n            )}\n            {openBugModal && (\n              <BugsForm\n                authUser={authUser}\n                supportType={supportType}\n                handleCancel={() => {\n                  resetFields();\n                  setVisible(false);\n                }}\n                handleSubmit={handleBugSubmit}\n                form={form}\n                loading={btnLoading}\n              />\n            )}\n          </div>\n\n          <button\n            className='close-btn'\n            onClick={() => {\n              setVisible(false);\n            }}\n          >\n            <img\n              alt='#'\n              src={require('../../../src/assets/images/popup/close.svg')}\n            />\n          </button>\n        </Dialog>\n      )}\n\n      {deleteModal && (\n        <ConfirmPopup\n          value={getRecord}\n          visible={deleteModal}\n          title={`Delete Note -  ${getRecord.query}`}\n          description='Are you want to delete this record'\n          onOk={() => {\n            handleDelete(getRecord && getRecord._id);\n          }}\n          okText='Yes'\n          cancelText='Cancel'\n          onClose={() => {\n            setDeleteModal(false);\n          }}\n          onCancel={() => {\n            setDeleteModal(false);\n          }}\n        />\n      )}\n\n      {attechmentVisible && (\n        <Uploader\n          visible={attechmentVisible}\n          onRequestClose={() => setattechmentVisible(false)}\n          multiple={true}\n          title='View Attechment'\n          // defaultList={fileData?.map((data) => {\n          //   return data?.path;\n          // })}\n          uploadUrl={{ ...fileUpload }}\n          allowedTypes={FILE_TYPES.IMAGE}\n          extraData={{\n            isUploadToS3: true,\n            category: [FILE_CATEGORY.IMAGE].join(','),\n          }}\n          maxSizeInMB={1}\n          onError={(err) => {\n            Toast.error(err);\n          }}\n          onSuccess={(uploaded) => {\n            if (uploaded?.code === 'OK') {\n              setAttechment(uploaded.data);\n              setattechmentVisible(false);\n            }\n          }}\n        />\n      )}\n\n      {visibleImage &&\n        <LightBox\n          visible={visibleImage}\n          images={detail}\n          onCloseRequest={() => handleViewImages(false)}\n          curImg={0}\n          imageTitle={{ caption: true }}\n        />}\n    </>\n  );\n};\nconst mapStateToProps = ({ auth }) => {\n  const { authUser } = auth;\n  return {\n    authUser,\n  };\n};\n\nexport default connect(mapStateToProps)(createForm()(Support));\n"]},"metadata":{},"sourceType":"module"}